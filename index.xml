<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>philip&#39;s curve</title>
<link>https://www.philipscurve.com/</link>
<atom:link href="https://www.philipscurve.com/index.xml" rel="self" type="application/rss+xml"/>
<description></description>
<generator>quarto-1.6.24</generator>
<lastBuildDate>Tue, 01 Oct 2024 00:00:00 GMT</lastBuildDate>
<item>
  <title>US-China Tensions and the Transformation of Penang’s Tech Industry</title>
  <dc:creator>Philip Khor</dc:creator>
  <link>https://www.philipscurve.com/post/chips.html</link>
  <description><![CDATA[ 





<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>First published in Penang Monthly (<a href="https://www.penangmonthly.com/us-china-tensions-the-transformation-of-penangs-tech-industry-2/">October 2024</a>).</p>
</div>
</div>
<p>Tiny semiconductors are the hidden engines behind today’s tech marvels, from artificial intelligence (AI) to electric cars. The semiconductor industry continues to cram an increasing number of elements onto integrated circuits<sup>1</sup>. In 1965, Gordon Moore, a founder of Intel, predicted that the number of transistors on chips would double every two years, a phenomenon referred to as Moore’s Law. Remarkably, the industry has mostly kept pace with Moore’s prediction—Apple’s M2 Ultra, for example, contains a staggering 134 billion transistors.</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;Moore’s 1965 paper was titled “Cramming More Components onto Integrated Circuits”.</p></div></div><p>Miniaturisation may be hitting a wall, but chip advancements are surging ahead. Design innovations like improved architecture and 3D stacking are cramming more power into existing transistors. For instance, Apple’s groundbreaking M-series chips condense immense processing power for next-generation smartphones and laptops. Specialised AI chips further accelerate application-specific performance, while innovations in compound semiconductors like silicon carbide and gallium nitride promise breakthroughs in <a href="https://semiengineering.com/unleashing-the-potential-of-compound-semiconductors-industry-leaders-collaborate-at-semicon-taiwan-2022-to-create-ecosystem/">data centres, cars, and communications</a>.</p>
<p><img src="https://www.philipscurve.com/images/clipboard-1464707813.png" class="img-fluid"></p>
<p><img src="https://www.philipscurve.com/images/clipboard-2841476697.png" class="img-fluid"></p>
<section id="chip-manufacturing" class="level2">
<h2 class="anchored" data-anchor-id="chip-manufacturing">Chip manufacturing</h2>
<p>A marvel of engineering and a poster child for globalisation, the semiconductor industry thrives on a complex, geographically distributed supply chain. No single country reigns supreme; specialised firms around the world contribute to different parts of the supply chain. While cutting-edge fabrication plants (fabs) are concentrated in a few regions, other parts are scattered globally.</p>
<p>As miniaturisation nears its limits, value is migrating from shrinking transistors in the front-end of semiconductor manufacturing to maximising their efficiency through clever design. Design contributes a majority of the industry’s value, according to a 2021 BCG report.</p>
<p>Take NVIDIA, the world’s most valuable chip company. They design chips but outsource manufacturing giants like TSMC (Taiwan Semiconductor Manufacturing Company) handle the actual production. This “pure-play foundry” model empowers tech giants like Microsoft, Google, and Meta to design their own chips without fabs – as “fabless” chipmakers.</p>
<p><img src="https://www.philipscurve.com/images/clipboard-1504559797.png" class="img-fluid"></p>
<p>Chipmaking starts with slicing ultra-pure silicon into wafers. These wafers are etched with intricate designs using cutting-edge photolithography equipment, commonly procured from the Dutch manufacturer ASML. Once etched, the chips are assembled and tested, with locations like China, Vietnam, and Penang playing a role. Finally, the packaged chips are integrated into circuit boards for everything from phones to smart sensors.</p>
<p>While chip assembly (back-end) is traditionally seen as less valuable, innovations like 3D stacking are boosting its importance. Packaging-related innovations allow for more powerful chips despite miniaturisation limits. As a result, the future may see value more evenly distributed across all chipmaking stages, with each playing a crucial role in maximising performance.</p>
</section>
<section id="a-geopolitical-pivot-creates-opportunity" class="level2">
<h2 class="anchored" data-anchor-id="a-geopolitical-pivot-creates-opportunity">A Geopolitical Pivot Creates Opportunity</h2>
<p>Despite short-term weakness from a <a href="https://www.reuters.com/technology/chipmakers-signal-supply-glut-easing-demand-recovery-still-slow-2023-07-28/">supply glut</a>, the chip industry’s future looks bright. As of Q1 2024, microelectronics industry association SEMI reports <a href="https://www.semi.org/en/news-media-press-releases/semi-press-releases/key-measures-of-global-semiconductor-manufacturing-strength-improve-in-q1-2024-semi-reports">positive trends</a> in sales, inventories, and factory capacity. While demand recovery <a href="https://www.semi.org/en/news-media-press-releases/semi-press-releases/key-measures-of-global-semiconductor-manufacturing-strength-improve-in-q1-2024-semi-reports">varies by sector</a>, leaders see <a href="https://kpmg.com/kpmg-us/content/dam/kpmg/pdf/2024/global-semiconductor-industry-outlook.pdf">automotive and AI</a> as 2024’s growth engines, with <a href="https://www.spglobal.com/marketintelligence/en/mi/research-analysis/state-and-outlook-for-semiconductor-supply-chains-2024-beyond.html">AI infrastructure</a> (especially data centres) following closely. The sluggish consumer electronics market, particularly smartphones, is looking to on-device (<a href="https://www.semi.org/en/news-media-press-releases/semi-press-releases/key-measures-of-global-semiconductor-manufacturing-strength-improve-in-q1-2024-semi-reports">‘edge’</a>) AI, powered by neural processing units (NPUs), for a comeback.</p>
<p>In spite of the global chip slowdown, Penang’s electronics sector has soared. In 2021, foreign approved manufacturing investment skyrocketed to RM 74 billion, a tenfold increase from the past decade’s average (RM 6 billion), where 98.7% (2021) was attributed to the electrical and electronics (E&amp;E) sector. This surge accompanies double-digit production growth (GDP) for Penang’s electronics industry in both 2021 (+16.5%) and 2022 (+21.8%).</p>
<p>Penang, a leader in back-end processes since the 1970s, is a prime beneficiary of the electronics industry’s shift towards geographical diversification. KPMG’s <a href="https://kpmg.com/kpmg-us/content/dam/kpmg/pdf/2024/global-semiconductor-industry-outlook.pdf">2024 survey</a> reveals that 53% of firms plan to diversify their supply chains in the coming year. The COVID-19 pandemic and accompanying 2021 chip shortage highlighted the need for stronger supply chains. Concerns about future disruptions, from extreme weather to tensions around Taiwan, further emphasise this need.</p>
<p>The shift is expedited by the US-China “chip war”, where the US has tried to limit China’s tech growth with export restrictions and the CHIPS Act, which funds US chip production but restricts recipients from expanding in China. Since then, construction of electronics-related manufacturing in the States has grown <a href="https://www.ft.com/content/26756186-99e5-448f-a451-f5e307b13723">15-fold</a>, although slow grant disbursement and talent shortages threaten to slow US chip projects.</p>
<p>On the other hand, China has been heavily investing in its chip industry, aiming for self-sufficiency by subsidising domestic companies and recruiting foreign talent. While Chinese firms excel in mature chips, it is unclear how much the US has managed to slow China’s progress in advanced chip development.</p>
</section>
<section id="the-national-semiconductor-strategy" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="the-national-semiconductor-strategy">The National Semiconductor Strategy</h2>
<p>Amidst intensifying rivalry between these two great powers, Malaysia, with its neutral position in regards to US-China relations, is well-placed to accommodate both Western allies seeking to diversify supply chains as well as Chinese firms trying to dodge American sanctions. In launching the National Semiconductor Strategy, prime minister Anwar Ibrahim touted Malaysia as the <a href="https://fortune.com/asia/2024/05/29/malaysia-prime-minister-anwar-ibrahim-touts-country-neutral-nonaligned-home-chip-companies-semiconductors-us-china/">“most neutral and non-aligned location for semiconductor production”</a>, and in a interview with the Financial Times, he expressed Malaysia’s position to maintain <a href="https://www.ft.com/content/929541ce-32fc-4f5f-9b9e-714b62f6e712">“good stable relations with the US [while] looking at China as an important ally”</a>.</p>
<p>While Malaysian observers have celebrated the launch of the strategy, in reality Malaysia is playing catch-up to a heated global semiconductor subsidy race. Anwar’s May 2024 announcement comes a full year after the UK, a leading chip design economy, launched its semiconductor strategy, following local chip bosses’ threats to move out of the UK if a plan was not launched.</p>
<p>The strategy is ambitious, targeting each portion of the semiconductor supply chain. Talent has been identified as a critical factor for the success of the local semiconductor industry, with plans to increase semiconductor talent tenfold. While substantial, the RM 25 billion (USD 5.33 billion) allocated pales in comparison to other states’ spending on chips: equivalent to just 13 ASML extreme ultraviolet (EUV) lithography machines at RM1.9 billion each, as pointed out in an opinion piece by semiconductor employee <a href="https://www.themalaysianinsight.com/s/483829">Ooi Tze Howe</a>.&nbsp;</p>
<p><img src="https://www.philipscurve.com/images/clipboard-2637121903.png" class="img-fluid"></p>
<p>As part of the Strategy, Putrajaya aspires to be at the cutting edge of semiconductor manufacturing across all stages of manufacturing. With the ballooning costs of building semiconductor fabs, Malaysia’s competitiveness in cutting-edge fabs is unclear, particularly as Malaysia competes against generous <a href="https://www.bcg.com/publications/2023/navigating-the-semiconductor-manufacturing-costs">state subsidies targeting fab construction</a>. Indeed, the PM’s address specifically mentions trailing-edge chips and power chips, which are less capital intensive to produce, for the first phase of the strategy.</p>
<p>Considering the high resource intensity of the fabrication process, expansion of the semiconductor industry requires responsible, forward-looking stewardship of environmental resources, in the face of the looming threat of climate change. By <a href="https://fortune.com/2024/01/29/chips-act-semiconductor-factories-environmental-impact-water-electricity-carbon-chemical-waste/">some estimates</a>, an advanced fab consumes</p>
<ul>
<li><p>several million gallons of water daily<sup>2</sup>, equivalent to a small town, and</p></li>
<li><p>as much as 100 megawatt-hours of electricity per hour, or around one-eight of peak energy demand on Penang Island, while</p></li>
<li><p>producing thousands of tonnes of chemical waste annually.</p></li>
</ul>
<div class="no-row-height column-margin column-container"><div id="fn2"><p><sup>2</sup>&nbsp;Some semiconductor manufacturers have made great strides towards reducing their water use: Intel’s Penang plant for example returned and restored 89% of its water use in 2023, and some Intel sites actually return/restore more water than used (2023-24 Intel Corporate Responsibility Report).</p></div></div><p>Alongside Malaysia’s bullish posture towards data centres, Malaysia must consider if it has the means to support the resource needs of its fab aspirations.</p>
<p>On the other hand, commentators have pointed out the potential of scaling up Malaysia’s chip design industry, although as a highly knowledge-intensive industry, there are substantial barriers to entry. Thus far, only one chip design company, Oppstar, is listed on the Malaysian stock market. As with chip fabrication, Malaysia competes with substantial public investments by countries with first-mover advantage at the <a href="https://web-assets.bcg.com/3f/b4/fd384ccd46dc8a381bd61a648105/bcg-the-growing-challenge-of-semiconductor-design-leadership-nov-2022-r.pdf">design stage</a>.&nbsp;</p>
<p>In line with these aspirations, Penang’s chief minister Chow Kon Yeow has <a href="https://api.nst.com.my/news/nation/2024/07/1082406/new-penang-silicon-design-5km-initiative-set-boost-ee-ecosystem">announced plans</a> for the Penang Silicon Design @5KM initiative, which includes facilities catered towards high-value activities—in particular chip <a href="https://www.thevibes.com/articles/news/102874/penang-on-target-to-becoming-global-integrated-circuit-hub-says-kon-yeow">design and research and development (R&amp;D)</a><strong>—</strong>and talent development strategies<sup>3</sup>.</p>
<div class="no-row-height column-margin column-container"><div id="fn3"><p><sup>3</sup>&nbsp;Penang’s state-level talent development framework is outlined in Penang STEM Talent Blueprint: A Roadmap for Workforce Development (2024), available at https://penanginstitute.org/publications/reports-and-papers/penang-stem-talent-blueprint-a-roadmap-for-workforce-development/.</p></div></div><p>What is certain is that multinationals will continue to drive Malaysia’s semiconductor industry. In the past, Penang’s backend ecosystem has created opportunities for local companies in automated equipment and services. Intel’s establishment of its first 3D packaging facility outside the US in Penang comes alongside the increased importance of advanced chip packaging, potentially raising the value of backend operations. This collaborative approach, combining homegrown talent with the expertise of global players, positions Penang for future success.</p>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>The US-China tensions present a complex scenario, fraught with both challenges and immense opportunities. Penang is well-positioned to capitalise on this unique moment. By strategically investing in upskilling its workforce and fostering a culture of innovation, the state can solidify its place as a prominent player in the global tech arena. Embracing advanced packaging technologies and design capabilities will be paramount in this transformation. Penang can leverage its existing strengths in manufacturing to create a robust ecosystem that integrates design, cutting-edge technology, and a skilled workforce. This holistic approach will ensure Penang remains a relevant and thriving tech hub in the years to come.</p>


</section>


 ]]></description>
  <guid>https://www.philipscurve.com/post/chips.html</guid>
  <pubDate>Tue, 01 Oct 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Pay for progress: do head of state governments’ pay respond to performance?</title>
  <dc:creator>Philip Khor</dc:creator>
  <link>https://www.philipscurve.com/post/mbpay.html</link>
  <description><![CDATA[ 





<p>Malaysiakini’s data journalism team just published this fascinating analysis about the salaries of states’ heads of government:</p>
<iframe src="https://www.facebook.com/plugins/post.php?href=https%3A%2F%2Fwww.facebook.com%2FMalaysiakini%2Fposts%2Fpfbid0TZGSiFUWrXvDFzXVrNgMqdrCgmzL2BCfPjXFRXP4QftL5U5bBNVWNjzEsjPcDKbpl&amp;show_text=true&amp;width=500" width="500" height="718" style="border:none;overflow:hidden" scrolling="no" frameborder="0" allowfullscreen="true" allow="autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share"></iframe>
<div class="cell">
<details class="code-fold">
<summary>Show setup code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tibble)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(arrow)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyr)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(readr)</span>
<span id="cb1-7">hies_state <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_parquet</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://storage.dosm.gov.my/hies/hies_state.parquet"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(lubridate<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">year</span>(date) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2022</span>)</span>
<span id="cb1-9"></span>
<span id="cb1-10">hies_pct <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_parquet</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://storage.dosm.gov.my/hies/hies_state_percentile.parquet"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(lubridate<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">year</span>(date) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2022</span>, percentile <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>), variable <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"maximum"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(percentile), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> income, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_prefix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pct_"</span>)</span>
<span id="cb1-13"></span>
<span id="cb1-14">wellbeing <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_parquet</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://storage.dosm.gov.my/dashboards/wellbeing_state_choropleth.parquet"</span>)</span>
<span id="cb1-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tribble</span>(</span>
<span id="cb1-16">  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> state, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> head_executive_pay, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> gdppercap, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>median_wage,</span>
<span id="cb1-17">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Kelantan"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16836</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1600</span>,</span>
<span id="cb1-18">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sabah"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">33033</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">31147</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1800</span>, </span>
<span id="cb1-19">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Terengganu"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">31111</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1900</span>, </span>
<span id="cb1-20">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Perlis"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24004</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1627</span>, </span>
<span id="cb1-21">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Kedah"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">22000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">26353</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1845</span>, </span>
<span id="cb1-22">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Perak"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">37170</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>, </span>
<span id="cb1-23">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Pahang"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">46084</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>,</span>
<span id="cb1-24">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sarawak"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">39000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">72411</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>, </span>
<span id="cb1-25">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Malaysia"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">22826</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">54612</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2600</span>, </span>
<span id="cb1-26">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Selangor"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">62492</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2900</span>, </span>
<span id="cb1-27">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Negeri Sembilan"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19175</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">51709</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2245</span>,  </span>
<span id="cb1-28">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Johor"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14907</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">41902</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2400</span>, </span>
<span id="cb1-29">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Melaka"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">53922</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2282</span>, </span>
<span id="cb1-30">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Pulau Pinang"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14175</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">72586</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2645</span></span>
<span id="cb1-31">) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> exec_pay</span></code></pre></div>
</details>
</div>
<p>They find that there’s no relationship between the head of government’s pay and the state’s economic performance, as measured by GDP per capita:</p>
<div class="cell">
<details class="code-fold">
<summary>Show setup code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(exec_pay, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> gdppercap, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> head_executive_pay)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> ggrepel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text_repel</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> state))</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.philipscurve.com/post/mbpay_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>correlation coefficient (log-log): 0.0040797</p>
<p>and similarly for wages - if anything, they seem to be earning <em>less</em> where household income is higher? <sup>1</sup></p>
<div class="cell">
<details class="code-fold">
<summary>Show setup code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(exec_pay, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> median_wage, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> head_executive_pay)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> ggrepel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text_repel</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> state))</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.philipscurve.com/post/mbpay_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>correlation coefficient: -0.3210184</p>
<p>So I thought okay, maybe there’s something that isn’t captured in either of these metrics. Now that data is much easier to access on data.gov.my I thought I’d see if there’s any relationship between MB pay and 2022 values for the Malaysia Well-Being Index.</p>
<p>Yeah, this is very data-miney, but I think it’s quite far from what we saw before, that there’s <em>no</em> relationship. Below are the Pearson correlation coefficients. The index is made up of economic and social components. The economic and overall components are modestly correlated; at the sub-indicator levels, it looks like safety is the most closely linked to MB pay.</p>
<div class="cell">
<details class="code-fold">
<summary>Show setup code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">wellbeing <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inner_join</span>(exec_pay, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"state"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(overall<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>social_family, \(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cor</span>(x, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(head_executive_pay)))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">everything</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(value))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cat =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb4-7">    name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"overall"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"economy"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"social"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"overall"</span>, </span>
<span id="cb4-8">    stringr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_sub</span>(name, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">end =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"social"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"social"</span>, </span>
<span id="cb4-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.default =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"economy"</span>), </span>
<span id="cb4-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cat =</span> forcats<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct</span>(cat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"overall"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"economy"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"social"</span>)),</span>
<span id="cb4-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> stringr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_remove</span>(name, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".+</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_"</span>),</span>
<span id="cb4-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> forcats<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_reorder</span>(name, value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-13">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">groupname_col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cat'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-14">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_number</span>() </span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="mrsfqotlmm" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mrsfqotlmm table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mrsfqotlmm thead, #mrsfqotlmm tbody, #mrsfqotlmm tfoot, #mrsfqotlmm tr, #mrsfqotlmm td, #mrsfqotlmm th {
  border-style: none;
}

#mrsfqotlmm p {
  margin: 0;
  padding: 0;
}

#mrsfqotlmm .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mrsfqotlmm .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mrsfqotlmm .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mrsfqotlmm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mrsfqotlmm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mrsfqotlmm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mrsfqotlmm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mrsfqotlmm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mrsfqotlmm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mrsfqotlmm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mrsfqotlmm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mrsfqotlmm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mrsfqotlmm .gt_spanner_row {
  border-bottom-style: hidden;
}

#mrsfqotlmm .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mrsfqotlmm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mrsfqotlmm .gt_from_md > :first-child {
  margin-top: 0;
}

#mrsfqotlmm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mrsfqotlmm .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mrsfqotlmm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mrsfqotlmm .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mrsfqotlmm .gt_row_group_first td {
  border-top-width: 2px;
}

#mrsfqotlmm .gt_row_group_first th {
  border-top-width: 2px;
}

#mrsfqotlmm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mrsfqotlmm .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mrsfqotlmm .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mrsfqotlmm .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mrsfqotlmm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mrsfqotlmm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mrsfqotlmm .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mrsfqotlmm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mrsfqotlmm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mrsfqotlmm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mrsfqotlmm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mrsfqotlmm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mrsfqotlmm .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mrsfqotlmm .gt_left {
  text-align: left;
}

#mrsfqotlmm .gt_center {
  text-align: center;
}

#mrsfqotlmm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mrsfqotlmm .gt_font_normal {
  font-weight: normal;
}

#mrsfqotlmm .gt_font_bold {
  font-weight: bold;
}

#mrsfqotlmm .gt_font_italic {
  font-style: italic;
}

#mrsfqotlmm .gt_super {
  font-size: 65%;
}

#mrsfqotlmm .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mrsfqotlmm .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mrsfqotlmm .gt_indent_1 {
  text-indent: 5px;
}

#mrsfqotlmm .gt_indent_2 {
  text-indent: 10px;
}

#mrsfqotlmm .gt_indent_3 {
  text-indent: 15px;
}

#mrsfqotlmm .gt_indent_4 {
  text-indent: 20px;
}

#mrsfqotlmm .gt_indent_5 {
  text-indent: 25px;
}

#mrsfqotlmm .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#mrsfqotlmm div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="name" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">name</th>
<th id="value" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">value</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<td colspan="2" id="social" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">social</td>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_center" headers="social  name">safety</td>
<td class="gt_row gt_right" headers="social  value">0.78</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="social  name">participation</td>
<td class="gt_row gt_right" headers="social  value">−0.53</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="social  name">culture</td>
<td class="gt_row gt_right" headers="social  value">−0.37</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="social  name">health</td>
<td class="gt_row gt_right" headers="social  value">−0.27</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="social  name">environment</td>
<td class="gt_row gt_right" headers="social  value">0.27</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="social  name">entertainment</td>
<td class="gt_row gt_right" headers="social  value">0.24</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="social  name">governance</td>
<td class="gt_row gt_right" headers="social  value">0.21</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="social  name">family</td>
<td class="gt_row gt_right" headers="social  value">−0.16</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="social  name">housing</td>
<td class="gt_row gt_right" headers="social  value">−0.14</td>
</tr>
<tr class="gt_group_heading_row odd">
<td colspan="2" id="overall" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">overall</td>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_center" headers="overall  name">economy</td>
<td class="gt_row gt_right" headers="overall  value">0.59</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="overall  name">overall</td>
<td class="gt_row gt_right" headers="overall  value">0.53</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="overall  name">social</td>
<td class="gt_row gt_right" headers="overall  value">0.18</td>
</tr>
<tr class="gt_group_heading_row odd">
<td colspan="2" id="economy" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">economy</td>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_center" headers="economy  name">income</td>
<td class="gt_row gt_right" headers="economy  value">0.55</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="economy  name">educ</td>
<td class="gt_row gt_right" headers="economy  value">0.44</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="economy  name">work</td>
<td class="gt_row gt_right" headers="economy  value">0.25</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="economy  name">comms</td>
<td class="gt_row gt_right" headers="economy  value">0.12</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="economy  name">transport</td>
<td class="gt_row gt_right" headers="economy  value">−0.08</td>
</tr>
</tbody>
</table>

</div>
</div>
<details class="code-fold">
<summary>Show setup code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ggplot(aes(x = value, y = name)) + </span></span>
<span id="cb5-2">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># geom_col() + </span></span>
<span id="cb5-3">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ggrepel::geom_text_repel(aes(label = round(value, 2))) + </span></span>
<span id="cb5-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># facet_wrap(vars(cat), scale = "free_y") + labs(y = "", x = "")</span></span></code></pre></div>
</details>
</div>
<p>It kind of makes sense for politicians to be rewarded for economic welfare and social safety. So is the system … working?</p>
<p>It’s never a good idea to take a metric at face value, so let’s plot the index versus MB pay.</p>
<div class="cell">
<details class="code-fold">
<summary>Show setup code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">wellbeing <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inner_join</span>(exec_pay, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"state"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> overall <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> head_executive_pay)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb6-4">  ggrepel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text_repel</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> state), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb6-5">  ggthemes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_fivethirtyeight</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb6-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> \(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"+"</span>, x, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb6-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb6-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb6-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Progress in overall well-being is correlated with MB pay"</span>,</span>
<span id="cb6-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Head of government's pay versus change in overall Malaysia Well-being Index since 2010"</span>,</span>
<span id="cb6-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Change since 2010"</span>, </span>
<span id="cb6-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Head of government's pay"</span></span>
<span id="cb6-13">  )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.philipscurve.com/post/mbpay_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Seems fairly legit to me, except for Penang that’s underpaying, probably a legacy of a past administration’s belt-tightening approach to governance.</p>
<p>At this point it’s a good idea to take a step back and think about what the index means. I think the documentation wasn’t very clear, but essentially, each state has the value 100 for 2010. In other words, the index values for each state measure ‘overall progress’ on various indicators since 2010.</p>
<p>The strongest economic indicator has to do with income and distribution, and includes</p>
<ul>
<li>GDP per capita</li>
<li>poverty rate</li>
<li>Gini coefficient of household income</li>
</ul>
<p>The correlation between executive pay and this sub-indicator seems modest (0.5493465).</p>
<div class="cell">
<details class="code-fold">
<summary>Show setup code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">income_index <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> economy_income <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> head_executive_pay)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb7-3">  ggrepel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text_repel</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> state), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb7-4">  ggthemes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_fivethirtyeight</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb7-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> \(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"+"</span>, x, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb7-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb7-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb7-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Progress in the income and distribution index is correlated with MB pay"</span>,</span>
<span id="cb7-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Head of government's pay versus change in the income and distribution index since 2010"</span>,</span>
<span id="cb7-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Change since 2010"</span>, </span>
<span id="cb7-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Head of government's pay"</span></span>
<span id="cb7-12">  )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.philipscurve.com/post/mbpay_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Okay great, but this doesn’t tell me much about what exactly about state’s economies that heads of government are rewarded for. <sup>2</sup> So I compare the annual growth of a few economic welfare metrics between 2016 and 2022.</p>
<section id="gdp-per-capita-growth-between-2016-and-2022-0.6380104" class="level2">
<h2 class="anchored" data-anchor-id="gdp-per-capita-growth-between-2016-and-2022-0.6380104">GDP per capita growth between 2016 and 2022: 0.6380104</h2>
<div class="cell">
<details class="code-fold">
<summary>Show setup code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">gdp_growth <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb8-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rat2216</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> head_executive_pay)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-3">    ggrepel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text_repel</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">State</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb8-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_percent</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb8-5">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Are MBs/CMs rewarding themselves for economic growth?"</span>, </span>
<span id="cb8-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Head of government's pay vs annual growth rate of GDP per capita between 2016 and 2022"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb8-7">      ggthemes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_fivethirtyeight</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb8-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing non-finite outside the scale range
(`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_text_repel()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.philipscurve.com/post/mbpay_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="household-income-growth-between-2016-and-2022-0.0952284" class="level2">
<h2 class="anchored" data-anchor-id="household-income-growth-between-2016-and-2022-0.0952284">Household income growth between 2016 and 2022: 0.0952284</h2>
<div class="cell">
<details class="code-fold">
<summary>Show setup code</summary>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">hhinc_growth <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb13-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> rat2216, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> head_executive_pay)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb13-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> state)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb13-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_percent</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb13-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"annual growth rate"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"annual head of government pay"</span>) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> p1</span></code></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.philipscurve.com/post/mbpay_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="change-in-inequality--0.4524236" class="level2">
<h2 class="anchored" data-anchor-id="change-in-inequality--0.4524236">Change in inequality: -0.4524236</h2>
<p>i.e.&nbsp;less inequality, more pay</p>
<div class="cell">
<details class="code-fold">
<summary>Show setup code</summary>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">gini_growth <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> rat2216 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> head_executive_pay)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb14-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> state)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb14-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"change in gini between 2022 and 2016, percentage points"</span>, </span>
<span id="cb14-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"annual head of government pay"</span>, </span>
<span id="cb14-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Scale reversed for clarity. Greater gini is less equal, states are more equal towards the right of the x-axis "</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb14-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_reverse</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.philipscurve.com/post/mbpay_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This seems to suggest … the system is working?</p>
<p>Honestly, I’m more surprised to find that there seems to be some relationship between state heads’ salaries and their performance, than the other way round. Good to know though.</p>
<p>If anything, I think it makes more sense that politicians in states that progress faster are compensated better, rather than for politicians to be compensated for the work of those than come before them.</p>
</section>
<section id="sidenote" class="level1">
<h1>Sidenote</h1>
<p>On the other hand, I think there’s value in comparing top-of-the-line pay with the pay of those at the bottom. Newly released Data.gov.my data from the Household Income Surveys help us do that. Below I show how many times’ the head of government’s salary is of different percentiles in the household income distribution.</p>
<p>For instance, the Sarawak head of government earns almost 8 times that of the median Sarawakian household, over 13 times that of the bottom 20% of Sarawakian households, and almost 35 times that of the bottom 1% of Sarawakian households.</p>
<div class="cell">
<details class="code-fold">
<summary>Show setup code</summary>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">exec_pay <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb15-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inner_join</span>(hies_state, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"state"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb15-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inner_join</span>(hies_pct, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"state"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb15-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb15-5">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(income_median, expenditure_mean, pct_1, pct_20), \(x) head_executive_pay <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> x),</span>
<span id="cb15-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">state =</span> forcats<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_reorder</span>(state, income_median)</span>
<span id="cb15-7">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb15-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(income_median, pct_1, pct_20)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb15-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> forcats<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_reorder</span>(name, value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb15-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> state, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_col</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(name), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free_x"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb15-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, </span>
<span id="cb15-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Head of government's salary as multiple of household income metrics"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.philipscurve.com/post/mbpay_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>I didn’t verify if Malaysiakini’s numbers were from administrative data or the salaries surveys↩︎</p></li>
<li id="fn2"><p>For comparability with the Household Income Survey, I go with 2016 to 2022.↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>R</category>
  <guid>https://www.philipscurve.com/post/mbpay.html</guid>
  <pubDate>Fri, 09 Aug 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Penang’s Evolving Schooling Preferences</title>
  <dc:creator>Philip Khor</dc:creator>
  <link>https://www.philipscurve.com/post/penang_ed/penanged.html</link>
  <description><![CDATA[ 





<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>First published in <a href="https://penangmonthly.com/article/21207/penangs-evolving-schooling-preferences">Penang Monthly (August 2024)</a>.</p>
</div>
</div>
<p>Penang’s education scene is changing rapidly. While Malaysia’s private school enrollment remains modest compared to the region, it is seeing a concerning shift. Public secondary schools in Penang are experiencing a drop in enrollment, while private institutions, particularly international schools, are booming. Is this a simple case of parents seeking better options, or is it something more? This trend raises concerns about a widening education divide and potential cracks in Penang’s social cohesion.</p>
<section id="the-allure-of-private-schools" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="the-allure-of-private-schools">The allure of private schools</h2>
<p>Malaysia boasts a relatively low private school enrollment rate compared to its Southeast Asian neighbours. However, a concerning trend threatens the long-held role of public education in fostering social cohesion.</p>
<p>Since the ban on citizens attending international schools was relaxed in 2008<sup>1</sup>, the share of secondary school-age children enrolling in private institutions has almost tripled from 3.4% (2002) to 9.4% (2021), while at the primary level, the rate has risen dramatically from just under 1% in 2002 to 6.3% (2021), even outpacing enrollment rates at the secondary level until recently.</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;<a href="https://asia.nikkei.com/NAR/Articles/Failing-state-schools-prompt-parents-to-go-private" class="uri">https://asia.nikkei.com/NAR/Articles/Failing-state-schools-prompt-parents-to-go-private</a></p></div></div><p><img src="https://www.philipscurve.com/post/penang_ed/images/clipboard-588100249.png" class="img-fluid"></p>
<p>Penang parents’ pivot towards private schools coincides with a surge in the popularity of private education nationally, spurring the recent proliferation of international schools in Penang. In Penang, public secondary school enrollment has declined by 19.2% over the past decade (2013 - 2023). Primary school enrollment decreased by 5.3%, comparable with a 6.2% decrease in Penang’s 5-14 population in the same period<sup>2</sup>. Concurrently, according to Ministry of Education reports, the number of international schools in Penang has risen from 8 to 12.</p>
<div class="no-row-height column-margin column-container"><div id="fn2"><p><sup>2</sup>&nbsp;According to the Department of Statistics Malaysia (DOSM) population estimates, Penang’s 5-14 citizen population decreased by 11% in the same period. Assuming the non-citizen population makes up a negligible portion of public school enrolment, the muted decrease in primary public school enrolment suggests that the citizen population may now be slightly more likely to attend public primary school. It is also important to note that Penang vernacular (primary) schools have seen double-digit declines in enrolment in the past decade (Chinese: -13%, Tamil: -11%; 2013-2023), while national primary schools have maintained their headcount.</p></div></div><p>The reduction in public school enrolment is unlikely to indicate a significant pattern of dropouts from formal education in Penang. However, this may be a concern at the national level. UIS statistics indicate that one in 20 (4.7%, 2022) primary school-age children in Malaysia do not attend any school. In Penang, public school enrollment in Year One alone (20,843, 2023) equals 96% of children born in 2016 (21,781). In contrast, Malaysia’s 2023 Year One public school enrolment (447,876) was only 88% of children born in 2016 (508,203).</p>
<p>The faster pace of decline in public secondary school enrolment, relative to Penang’s demographic changes, suggests that the shift in preference for private education dominates at the secondary level, as opposed to the primary level. Penang’s national primary school graduates are over twice as likely not to attend public secondary school than the average Malaysian Year Six student. Almost one in five (17.8%) eligible primary school graduates in Penang did not enrol in a secondary public school in the subsequent year, versus 8.3% for Malaysia (2023).</p>
<p><img src="https://www.philipscurve.com/post/penang_ed/images/clipboard-3627033546.png" class="img-fluid"></p>
<p>The outsized presence of Chinese-medium private schools is especially noteworthy. Although enrollment (5,702, June 2023) is on par with international schools (5,010, June 2023), it is crucial to consider that independent Chinese schools cater solely to the secondary level. Enrolment in these schools is almost double secondary-level enrolment in international schools in Penang (2,695, June 2023). For comparison, international and independent Chinese schools’ enrollment at the secondary level is equivalent to 8.7% of secondary-level students enrolled in public schools in Penang (96,896, 2023).</p>
<p>The demand for international education is booming in Penang. Enrolment in international schools has grown at 5.2% annually (cumulative annual growth rate, CAGR) between 2013 and 2023, outpacing plateauing enrollment growth in Chinese private schools (2.3% CAGR). According to a Tenby Schools Penang representative, this surge is driven by parents’ desire for their children to develop strong English language skills and benefit from a broader curriculum that fosters independent learning. Interestingly, primary-level enrollment in international schools is catching up with secondary-level enrollment, even surpassing secondary enrollment for a brief period in 2021. Tenby Schools Penang confirms this observation of a rising influx of younger students.</p>
<p><img src="https://www.philipscurve.com/post/penang_ed/images/clipboard-3728707937.png" class="img-fluid"></p>
<p>It is essential to note the substantial role of the religious private education sector<sup>3</sup>. Between various privately-run religious education entities, including people’s religious schools, private religious schools (sekolah agama swasta), tahfiz schools and sekolah pondok, Penang registered 8,836 students across 92 institutions in 2023, well exceeding international schools.</p>
<div class="no-row-height column-margin column-container"><div id="fn3"><p><sup>3</sup>&nbsp;An overview of the religious private education sector is beyond the scope of this article. For a primer, refer to The Potential of Independent Religious Schools: A Case Study of Al-Amin (Deviyati, 2016) and Three things about: Malaysia’s (private/ state-funded) Islamic schools (https://www.malaymail.com/news/malaysia/2017/04/29/three-things-about-malaysias-private-state-funded-islamic-schools/1366345).</p></div></div></section>
<section id="chinese-private-schools" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="chinese-private-schools">Chinese private schools</h2>
<p>Chinese private schools, also known as independent Chinese schools, enrol some 76,634 students in 60 schools across Malaysia (June 2023), five of which are in Penang<sup>4</sup>. These schools are also huge: each school enrols 1,140 students on average, more than double international schools, who enrol an average of 418 students per school in Penang. Almost all who enrol are Malaysian citizens, with reportedly only 0.87% of foreign enrolment in 2022 across Malaysia. The more prominent Chinese national-type public secondary schools—Penang Chinese Girls’ High School, Chung Ling High School and Jit Sin High School—co-locate with their private counterparts, blurring the lines between public and private education.</p>
<div class="no-row-height column-margin column-container"><div id="fn4"><p><sup>4</sup>&nbsp;<a href="https://www.espact.com.my/national-education-system/independent-chinese-schools/" class="uri">https://www.espact.com.my/national-education-system/independent-chinese-schools/</a></p></div></div><p><img src="https://www.philipscurve.com/post/penang_ed/images/clipboard-625087318.png" class="img-fluid"></p>
</section>
<section id="international-and-other-private-schools" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="international-and-other-private-schools">International and other private schools</h2>
<p>The international school sector presents a distinct picture. These schools primarily cater to expatriate children and affluent Malaysians seeking a globalised education<sup>5</sup>. Up to 2008, citizens were not allowed to attend international schools. Today, nationally, 55,999 Malaysian citizens comprise 70% (2023) of total student enrolment in international schools, and 50% more citizens enrol in international schools compared to 2017 (Beh, 2023). Unlike Chinese independent schools, which are more affordable, international school fees often put them out of reach for the average Penangite. International Schools Database estimates median fees for international schools in Penang to be USD 5,768 in 2022, amounting to 33% of the median Penang household’s annual income<sup>6</sup>.</p>
<div class="no-row-height column-margin column-container"><div id="fn5"><p><sup>5</sup>&nbsp;“Imagine an Education Hub: Leveraging Penang’s International School Ecosystem”, Beh, MT (2023) <a href="https://penanginstitute.org/publications/issues/imagine-an-education-hub-leveraging-penangs-international-school-ecosystem/#ftn1b" class="uri">https://penanginstitute.org/publications/issues/imagine-an-education-hub-leveraging-penangs-international-school-ecosystem/#ftn1b</a></p></div><div id="fn6"><p><sup>6</sup>&nbsp;Median household income is RM6,502 per month in 2022. Computed with KL USD/MYR reference rate of 4.4132 as at 30th December 2022.</p></div></div><div>

</div>
<div id="d" class="column-screen-inset-shaded quarto-layout-panel" data-layout-nrow="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<p><img src="https://www.philipscurve.com/post/penang_ed/images/clipboard-672339331.png" class="img-fluid"> <img src="https://www.philipscurve.com/post/penang_ed/images/clipboard-3063799982.png" class="img-fluid"></p>
</div>
</div>
</div>
</section>
<section id="the-great-education-debate" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="the-great-education-debate">The great education debate</h2>
<p>As Penang parents increasingly seek private education options, a complex national issue comes to light: Malaysia’s seemingly endless debate on how to run public schools, a tension dating back to the post-war period<sup>7</sup> with the Barnes and Fenn-Wu reports.</p>
<div class="no-row-height column-margin column-container"><div id="fn7"><p><sup>7</sup>&nbsp;Tze , Danny, Ken Wong, and Vivien Wong. “Chinese Education in a Multiethnic Society: Malaysia Experience.” The Cultural Legacies of Chinese Schools in Singapore and Malaysia, edited by Cheun Hoe Yow and Jingyi Qu, Routledge, 1 Mar.&nbsp;2021.</p></div></div><p>The focus on strengthening Malay language proficiency in public schools, a longstanding national goal, can sometimes overshadow broader discussions about public education. Meanwhile, advocates for Chinese language education and Christian communities grapple with safeguarding their historical and culturally significant schools, established during a period of diverse educational approaches, in the face of a more centralised national education system.</p>
<p>On the other hand, private schools are mostly shielded from the contentious political debates that plague public education discussions in Malaysia. However, this creates a two-tiered system, potentially entrenching social and educational disparities.</p>
<section id="different-languages" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="different-languages">Different languages</h3>
<p>The question of language has been a central theme in the evolution of Malaysia’s national education system. Although Malay is the main medium of instruction in public schools, science and maths education shifted towards English under the PPSMI policy during the Mahathir administration, and was subsequently reversed by the MBMMBI policy in 2010. The introduction of the Dual Language Programme (DLP) in 2016 provided some schools with the option to deliver science and maths in English, and is currently implemented in 2,501 schools across Malaysia<sup>8</sup>.</p>
<div class="no-row-height column-margin column-container"><div id="fn8"><p><sup>8</sup>&nbsp;<a href="https://www.thestar.com.my/news/nation/2024/03/14/dlp-now-in-2501-schools" class="uri">https://www.thestar.com.my/news/nation/2024/03/14/dlp-now-in-2501-schools</a></p></div></div><p>However, a recent change adds a new layer of complexity. Starting in the 2024/25 academic year, students must demonstrate basic Malay language skills to enrol in DLP classes. Additionally, DLP schools need to meet overall Malay language performance standards and offer at least one class with science and maths taught in Malay or the mother tongue.</p>
<p>The latter requirement in particular has caused confusion and frustration, especially in schools with no interest in non-DLP classes. According to press reports<sup>9</sup>, Year One students in Kuala Lumpur had to undergo extensive assessments in multiple languages and subjects to qualify for DLP enrollment, although the Ministry has clarified that it had not prescribed assessments to determine DLP eligibility.</p>
<div class="no-row-height column-margin column-container"><div id="fn9"><p><sup>9</sup>&nbsp;<a href="https://www.thestar.com.my/news/nation/2024/05/04/dlp-ball-back-in-schools-court" class="uri">https://www.thestar.com.my/news/nation/2024/05/04/dlp-ball-back-in-schools-court</a></p></div><div id="fn10"><p><sup>10</sup>&nbsp;Dewan Rakyat Hansard, 27th November 2023, p.103. Available at <a href="http://www.parlimen.gov.my/files/hindex/pdf/DR-27112023.pdf" class="uri">http://www.parlimen.gov.my/files/hindex/pdf/DR-27112023.pdf</a></p></div></div><p>Justifying the rule for non-DLP classes within DLP schools, the Education Minister cited low Malay language proficiency observed during field visits to five DLP schools, along with the need to safeguard the national language<sup>10</sup>.</p>
</section>
<section id="different-schools" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="different-schools">Different schools</h3>
<p>Penangites marked the end of an era when SMK Convent Pulau Tikus (CPT) and SMK Convent Light Street (CLS) shut down as government-aided schools in 2023<sup>11</sup>, not long after SK Pykett Methodist closed its doors in 2019. Representatives of the Infant Jesus Sisters (IJS)<sup>12</sup>, owner of the Convent schools, said they plan to convert these schools to private schools, and in 2020<sup>13</sup>, ACE Edventure announced plans to set up a private international school on the grounds of Convent Light Street. Likewise, Methodist College Kuala Lumpur (MCKL) has established its Pykett campus on the grounds of SK Pykett Methodist, a 20-minute drive from the new Wesley Methodist (International) School campus.</p>
<div class="no-row-height column-margin column-container"><div id="fn11"><p><sup>11</sup>&nbsp;<a href="https://www.thestar.com.my/news/nation/2023/04/01/tears-over-closing-of-two-secondary-convent-schools" class="uri">https://www.thestar.com.my/news/nation/2023/04/01/tears-over-closing-of-two-secondary-convent-schools</a></p></div><div id="fn12"><p><sup>12</sup>&nbsp;See The Devoted Pioneers of Girls’ Education in Malaya in the January 2016 issue for background on the IJS.&nbsp;</p></div><div id="fn13"><p><sup>13</sup>&nbsp;<a href="https://www.thestar.com.my/news/nation/2023/01/15/new-plans-for-convent-school" class="uri">https://www.thestar.com.my/news/nation/2023/01/15/new-plans-for-convent-school</a></p></div><div id="fn14"><p><sup>14</sup>&nbsp;Tze , Danny, Ken Wong, and Vivien Wong. “Chinese Education in a Multiethnic Society: Malaysia Experience.” The Cultural Legacies of Chinese Schools in Singapore and Malaysia, edited by Cheun Hoe Yow and Jingyi Qu, Routledge, 1 Mar.&nbsp;2021.</p></div><div id="fn15"><p><sup>15</sup>&nbsp;<a href="https://www.channelnewsasia.com/asia/malaysia-vernacular-schools-education-chinese-tamil-malay-national-unity-4277276" class="uri">https://www.channelnewsasia.com/asia/malaysia-vernacular-schools-education-chinese-tamil-malay-national-unity-4277276</a></p></div><div id="fn16"><p><sup>16</sup>&nbsp;<a href="https://www.thestar.com.my/news/nation/2024/03/16/dong-zong-urges-unity-govt-to-recognise-uec#:~:text=However%2C%20the%20UEC%20is%20yet,%3E" class="uri">https://www.thestar.com.my/news/nation/2024/03/16/dong-zong-urges-unity-govt-to-recognise-uec#:~:text=However%2C%20the%20UEC%20is%20yet,%3E</a></p></div><div id="fn17"><p><sup>17</sup>&nbsp;<a href="https://www.dongzong.my/v3/en/latest-news-2/notice-statement/1175-2022-78.html" class="uri">https://www.dongzong.my/v3/en/latest-news-2/notice-statement/1175-2022-78.html</a></p></div></div><p>These closures follow in the footsteps of independent Chinese schools, which diverged from the national system in the wake of the 1961 Education Act<sup>14</sup>. Meanwhile, although Chinese public schools have gained popularity amongst non-Chinese Malaysians<sup>15</sup>, concerns regarding government policies remain. Advocates for Chinese language education face frequent challenges, including the government’s reluctance to recognise the Unified Examination Certificate (UEC) issued by Chinese independent secondary schools<sup>16</sup> and a lack of transparency in funding for government-aided schools<sup>17</sup>.</p>
</section>
</section>
<section id="educating-a-diverse-population" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="educating-a-diverse-population">Educating a diverse population</h2>
<p>The rise of private education in Malaysia presents a challenge and an opportunity. The government must prioritise a two-pronged approach to revitalise public schools and ensure a cohesive educational landscape.</p>
<p>Firstly, addressing the root causes of the shift towards private education is crucial. The Ministry must actively listen to parents’ concerns, improve public school facilities and resources, and foster a more engaging and enriching learning environment. As the government moves towards rationalising civil service contracts<sup>18</sup>, pay packages and working conditions must remain attractive to prevent an outflow of talent towards the private education sector.</p>
<div class="no-row-height column-margin column-container"><div id="fn18"><p><sup>18</sup>&nbsp;<a href="https://www.nst.com.my/news/nation/2024/01/1004805/civil-servants-will-be-appointed-contract-service-system-pending-new" class="uri">https://www.nst.com.my/news/nation/2024/01/1004805/civil-servants-will-be-appointed-contract-service-system-pending-new</a></p></div></div><p>Secondly, the government needs to take decisive steps to depoliticise education. The Ministry must fully embrace Malaysia’s multilingualism as a core strength of the Malaysian education system, with a pragmatic approach to elevate Malay language proficiency while recognising English as the lingua franca of STEM, acknowledge the diversity of Malaysia’s education stakeholders, while guaranteeing policy stability for parents, students and teachers alike.</p>
<p>By fostering a more inclusive and high-performing public system, Malaysia can ensure every child receives a quality education, regardless of background or socioeconomic status. This vision is achievable if the government prioritises open communication, invests in quality education for all, and embraces the richness of Malaysia’s multicultural heritage.</p>


</section>


 ]]></description>
  <guid>https://www.philipscurve.com/post/penang_ed/penanged.html</guid>
  <pubDate>Thu, 01 Aug 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>EPF Account 3: Flexibility or Erosion of Retirement Savings?</title>
  <dc:creator>Philip Khor</dc:creator>
  <link>https://www.philipscurve.com/post/epf.html</link>
  <description><![CDATA[ 





<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>First published in <a href="https://penangmonthly.com/article/21163/epf-account-3-flexibility-or-erosion-of-retirement-savings">Penang Monthly (June 2024)</a>.</p>
</div>
</div>
<p>IN MAY 2024, Malaysia’s retirement savings fund, the Employees’ Provident Fund (EPF), restructured contributors’ accounts with the introduction of Account 3, a new, flexible account. The public, grappling with a rising cost of living, has been pressing for further withdrawal options. Account 3, emphasising flexibility, can be seen as a response to this pressure. However, concerns remain about the potential impact on long-term retirement security.</p>
<section id="what-is-account-3" class="level2">
<h2 class="anchored" data-anchor-id="what-is-account-3">What Is Account 3?</h2>
<p>Currently, 70% of EPF contributions go towards Account 1, which may only be withdrawn when members are 50. The remaining 30% is deposited in Account 2, which may be withdrawn earlier, subject to conditions set by the EPF.</p>
<p>With the new structure effective 11 May 2024, 10% of monthly contributions will now be channelled into Account 3, formally known as Akaun Fleksibel. 75% will be credited to Account 1, now known as Akaun Persaraan, while Account 2’s (now known as Akaun Sejahtera) share has been halved to 15% of contributions. Unlike the restrictions on the existing two accounts, funds in Akaun Fleksibel may be withdrawn at any time for any purpose. As part of the transition, members have up to 31 August 2024 to opt in to transfer part of their initial Account 2 balance to Akaun Fleksibel, subject to the balance remaining in Account 2.</p>
<p>The increased liquidity is a double-edged sword: although EPF members may be more inclined to contribute knowing they may withdraw money for emergencies, diverting hard-earned retirement funds to a readily accessible account might deplete retirement savings prematurely.</p>
<p><img src="https://www.philipscurve.com/images/clipboard-1009397881.png" class="img-fluid"></p>
</section>
<section id="a-cause-for-concern-low-epf-savings" class="level2">
<h2 class="anchored" data-anchor-id="a-cause-for-concern-low-epf-savings">A Cause for Concern: Low EPF Savings</h2>
<p>The introduction of Account 3 comes amid growing concern about Malaysians’ insufficient retirement savings in their EPF accounts. Recent reports indicate that many contributors, particularly those under 55, have critically low savings.</p>
<p>As of 2022, the median savings of active EPF members aged 54 was RM132,826<sup>1</sup>: in other words, 50% of active members retiring in 2022 have less than RM132,826 available for retirement, or equivalently, just over RM550 a month to spend over 20 years of life. This falls dramatically short of the minimum threshold set by the EPF, known as the Basic Savings Quantum, of RM240,000<sup>2</sup>at age 55, equivalent to RM1,000 per month for the next 20 years.</p>
<p>On an age-adjusted basis, the EPF estimates that as of May 2023, the share of members aged 18 to 55 meeting the basic savings requirement has declined from 20.4% pre-pandemic to 18.4% <del>post-pandemic</del><sup>3</sup>.</p>
<p>Furthermore, the share of Malaysia’s population covered by old-age protection is shockingly low; according to EPF estimates as of December 2023, three in five (or 58%) working-age adults do not have old-age protection, whether from active EPF contributions or the civil service pension scheme—a trend that is exacerbated with the rising popularity of informal employment<sup>4</sup>.</p>
<p>Malaysians’ retirement savings shortfall is a long standing issue worsened by policies accompanying the Movement Control Orders (MCOs) imposed at the onset of the Covid-19 pandemic. As government aid packages proved inadequate, the government initiated four special withdrawal programmes permitting EPF members to withdraw from their retirement savings. Economist Muhammed Abdul Khalid was quoted in a <em>Channel News Asia</em> article criticising the move as “the worst policy ever [that] the country has announced and implemented”.</p>
<p><img src="https://www.philipscurve.com/images/clipboard-2374354460.png" class="img-fluid"></p>
<p>When comparing EPF reports for 2019 and 2022, the magnitude of the depletion of savings for the most vulnerable EPF members is substantial. Across all active EPF members—although a quarter have more than RM100,000 in savings—another one in four members had less than RM10,000 in 2019, the rate of which has since risen to over one in three in 2022. Just under half (49.4%) of EPF members had less than RM35,000 in savings in 2019; median savings across active members has since fallen to around RM25,000 in 2022—a decline of about RM10,000. While the middle half of EPF members had RM10,000 to RM100,000 in savings in 2019, that range has since expanded to RM4,500 to RM100,000 in 2022.</p>
<p><img src="https://www.philipscurve.com/images/clipboard-3601227584.png" class="img-fluid"></p>
<p>Moreover, the burden of the pandemic has had a disproportionate impact on younger cohorts. Between 2019 and 2022, average savings for the under-25 and 26-to-35 cohorts have declined by 32% and 23% respectively, while savings for older cohorts were virtually unchanged, with the 46 to 55 cohort seeing an increase in savings.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.philipscurve.com/images/clipboard-239889811.png" class="img-fluid figure-img"></p>
<figcaption>The youngest members have suffered the largest proportional decrease in savings</figcaption>
</figure>
</div>
<p>The pensions provider is not to blame. The EPF is well-regarded for producing consistent and substantial returns. Benchmarked against individual earnings, it performs on par with East Asian counterparts and Organisation for Economic Co-operation and Development (OECD) economies: net pension wealth is 10.9 times individual net earnings for lower-earning men and women, compared to 13.6 (men) and 15 (women) times in the OECD<sup>5</sup>.</p>
<p>Rather, inadequate wages coupled with stagnating and uneven income growth is the primary driver for lacklustre retirement savings. Half of Malaysians working in the formal sector earn less than RM2,600 a month (<em>Formal Sector Wages</em>, Q3 2023), and 23.2% (2022) of employment in Malaysia lies in the informal sector. An <a href="https://penangmonthly.com/article/21165/on-the-proposed-progressive-wage-model-in-malaysia-1">article in Penang Monthly’s January 2024 issue</a> highlights how wages for semi-skilled workers grew by just 3.5% per annum between 2010 and 2022, even as low-skilled workers registered 5.7% in income growth, bolstered by minimum wage mandates<sup>6</sup>.</p>
<p>In a bid to build retirement savings, the government raised the voluntary contribution limit to RM100,000 per year in the 2023 Budget, up from RM60,000. Although contributions have risen by 15% from 2022<sup>7</sup> with just a quarter of active EPF members having more than RM100,000 in retirement savings, the policy does not help the majority of EPF members, although it may have been geared to shore up liquidity in anticipation of Account 3. Likewise, the Private Retirement Scheme introduced in 2012, while vital to liberalising the pension funds markets, should not be viewed as a solution for Malaysia’s retirement savings conundrum.</p>
<p>Worse yet, Malaysian households are highly indebted. In February 2024, household debt registered double-digit year-on-year growth in all segments except for personal use loans<sup>8</sup>. At 84.2% of gross domestic product (GDP) in December 2023<sup>9</sup>, Malaysia’s households accrued a high level of household debt, driven by an unbridled homeownership policy and car-centric urban planning. Debt repayments place considerable pressure on households’ ability to save, calling into question the use of strategies to boost savings as a fix for Malaysia’s retirement woes.</p>
<p>In the longer term, Malaysia’s ageing population is poised to further strain EPF members’ and government coffers. Today, the average 55-year-old Malaysian can expect to live 23.5 more years, which means that retirement savings will have to last over longer lifespans. At the same time, the EPF will have to deal with the consequences of a shrinking old-age support ratio on its asset mix as withdrawals outpace contributions.</p>
<p>At the fiscal level, it will be challenging for the government to finance additional old-age income security with declining tax revenue collected from a shrinking working-age population. Ironically, with the government declining to rationalise pensions for current civil servants, civil service pensions will continue to strain the government’s fiscal position in the near future<sup>10</sup>.</p>
</section>
<section id="the-epf-one-of-many-free-lunches" class="level2">
<h2 class="anchored" data-anchor-id="the-epf-one-of-many-free-lunches">The EPF: One of Many Free Lunches</h2>
<p>Einstein is, perhaps mistakenly, often credited with the quote that compound interest is the most powerful force in the universe. Indeed, with the EPF’s excellent track record of consistently paying around 5% in dividends each year, it would take just over 14 years to double your EPF contributions<sup>11</sup>.</p>
<p>Policymakers in Malaysia seem to concur, banking on the power of compound interest to support anything from children’s tertiary education (via the Perbadanan Tabung Pendidikan Tinggi Nasional—PTPTN) to retirement savings. In a way, the Malaysian approach attempts to control social spending by relying on dividends to support social goals.</p>
<p>For an example of this thinking, inspired by the establishment of Bank Rakyat, which has paid consistent double-digit dividends to its shareholders, former Tabung Haji chairman, Abdul Azeez Abdul Rahim, proposed in parliamentary debates the formulation of a new bank—Bank Rakyat 2.0—as a means to provide substantial dividends, particularly to lower-income communities<sup>12</sup>.</p>
<p>Unfortunately, this formula may be economically counterproductive and reinforces existing social inequalities. In a blog post, economist, Hafiz Noor Shams, posits that Malaysia’s landscape of high-return, risk-free investments, from Amanah Saham Bumiputera (ASB) to Tabung Haji, caters primarily to the already affluent and serves to the detriment of productive economic activity<sup>13</sup>.</p>
<p>The fledgling economics student is taught the mantra, “There is no free lunch.” The same applies to risk—investors need to be compensated with higher returns if they are to take on more risks. In an environment saturated with risk-free opportunities, households would be less likely to supply capital to productive investments, whether it be channelling money towards the financial markets or starting a business.</p>
<p>With 62% of its investments in the domestic market<sup>14</sup>, the EPF acknowledged the risk of “crowding out” domestic entrepreneurship in a 2023 interview with <em>The Edge</em>, although it does not believe it has crossed that juncture.</p>
<p>Moreover, relying solely on compound interest is of little help to members with limited income available for savings. 6.9% of the richest EPF members in 2022 hold almost half (49%) of active members’ savings, down from around 10% in 2022 (10.6% of members hold 52.5% of savings). Even more jarring, Hafiz observes how the top 1% of Tabung Haji depositors contribute half of the savings in the fund.</p>
<p>Persons involved in the informal sector, in particular, face volatile income streams, which may discourage them from contributing to the EPF. For them, design tweaks to the pensions system, such as Account 3, may provide peace of mind, knowing that their EPF contributions do not compromise their ability to deal with rainy-day expenses.</p>
<p>Indeed, Bank Negara Malaysia emphasises in its Economic and Monetary Review 2022 that long-term reforms are required to fix the structural issues underlying Malaysia’s low levels of retirement savings—in particular low wages, low savings and low informal sector coverage.</p>
</section>
<section id="what-to-consider" class="level2">
<h2 class="anchored" data-anchor-id="what-to-consider">What to Consider</h2>
<p>Account 3 strikes a balance between relaxing the prescriptive nature of Account 2 withdrawals and tightening the discipline of Account 1. With the introduction of Account 3, the revised EPF structure is a fair trade-off between increased flexibility and retirement security. Although withdrawals are more readily available than before, the flexible component of retirement contributions has, in fact, declined.</p>
<p>However, with many members’ savings depleted, at merely 10% of contributions, Account 3 will not be a substantial nor a sustainable safety net for most. Moreover, the one in three active members who has less than RM10,000 in retirement savings is faced with the prospect of withdrawing more than 10% of their retirement savings.</p>
<p>Importantly, Account 3 must not be regarded as an expansion of the social safety net. Rather, it is a compromise forced by the precedent of MCO-era policies allowing EPF withdrawals to fill the gaps of the social safety net. Therefore, it is laudable that the share of contributions flowing to Account 1 have been raised to preserve retirement savings and limit outflows that may be triggered by a hypothetical future withdrawals programme.</p>
<p>Crucially, the authorities must pursue bold strategies to raise wages to truly help households keep up with the cost of living and replenish retirement funds, such as:</p>
<ul>
<li><p>Restoring workers’ bargaining power: tackling Malaysia’s dwindling unionisation rate and enhancing labour dispute resolution systems may raise wages and improve working conditions.</p></li>
<li><p>Accelerate women’s participation in the workplace: by pursuing shared parental leave policies, promoting flexible work arrangements and preventing discrimination in the workplace, dismantling roadblocks to women’s participation in the workforce has the potential to double income sources within families.</p></li>
<li><p>Expanding the availability of support services: services such as financial planning and career guidance alongside a comprehensive social safety net can support upskilling, reskilling, entrepreneurship and other productive, enterprising pursuits.</p></li>
<li><p>Holistic strategies to promote well-being at the workplace: by tackling hazards such as extreme temperatures, accidents and diseases, workers’ earnings potential can be sustained and prolonged across their life course.</p></li>
</ul>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><a href="https://www.kwsp.gov.my/documents/d/guest/06_performance" class="uri">https://www.kwsp.gov.my/documents/d/guest/06_performance</a>↩︎</p></li>
<li id="fn2"><p>The EPF announced in December 2023 plans to raise the basic savings quantum to RM340,000 <a href="https://www.malaymail.com/news/malaysia/2023/12/05/epf-confidentprogressive-wage-policycan-boost-retirementsavings-by-54pc/105873" class="uri">https://www.malaymail.com/news/malaysia/2023/12/05/epf-confidentprogressive-wage-policycan-boost-retirementsavings-by-54pc/105873</a>↩︎</p></li>
<li id="fn3"><p>https://www.kwsp.gov.my/documents/d/guest/social-protectioninsight-vol-6_2023↩︎</p></li>
<li id="fn4"><p>https://www. freemalaysiatoday.com/category/nation/2024/03/03/40-of-17-million-workforce-not-covered-by-epf/↩︎</p></li>
<li id="fn5"><p>https://www.oecd-ilibrary.org/sites/2c555ff8-en/1/3/2/6/index.html?itemId=/content/publication/2c555ff8-en&amp;_csp_=618dc867ebfad4dd8ba60e3e2f8dcdf9&amp;itemIGO=oecd&amp;itemContentType=book↩︎</p></li>
<li id="fn6"><p>https://penangmonthly.com/article/21061/on-the-proposed-progressivewage-model-in-malaysia↩︎</p></li>
<li id="fn7"><p><a href="https://www.kwsp.gov.my/w/press-release-dividend2023" class="uri">https://www.kwsp.gov.my/w/press-release-dividend2023</a>↩︎</p></li>
<li id="fn8"><p>Household Debt, OpenDOSM↩︎</p></li>
<li id="fn9"><p>Financial Stability Review 2H 2023, BNM↩︎</p></li>
<li id="fn10"><p>See&nbsp;<a href="https://theedgemalaysia.com/node/700728" class="uri">https://theedgemalaysia.com/node/700728</a>&nbsp;for an overview of the government’s civil service pensions financial commitments.↩︎</p></li>
<li id="fn11"><p>Calculated with the Rule of 72, a quick estimate for determining how long an investment will take to double in value, assuming a constant compound interest rate. By dividing 72 by the annual interest rate (5% in this case), we get approximately 14 years. This suggests it would take roughly 14 years for your EPF contribution to double at a consistent 5% annual return. It’s important to note that the Rule of 72 is an approximation, and actual results may vary slightly.↩︎</p></li>
<li id="fn12"><p>Dewan Rakyat Hansard, 30th November 2021↩︎</p></li>
<li id="fn13"><p>&nbsp;<a href="https://maddruid.com/?p=17027" class="uri">https://maddruid.com/?p=17027</a>↩︎</p></li>
<li id="fn14"><p>https://thediplomat.com/2024/03/malaysias-state-run-investment-funds-had-amixed-2023/↩︎</p></li>
</ol>
</section></div> ]]></description>
  <guid>https://www.philipscurve.com/post/epf.html</guid>
  <pubDate>Sat, 01 Jun 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Brain drain: not as big a problem as you think</title>
  <dc:creator>Philip Khor</dc:creator>
  <link>https://www.philipscurve.com/post/braindrain.html</link>
  <description><![CDATA[ 





<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>First published on <a href="https://www.linkedin.com/pulse/brain-drain-big-problem-you-think-philip-khor-gjoec/?trackingId=Xom62RTXSZCaUPdNUc3CkA%3D%3D">LinkedIn</a>.</p>
</div>
</div>
<p>It’s curious why lots of Malaysians think that brain drain is a problem. We had a look at the numbers at work last year, and reality is a bit more nuanced.</p>
<section id="the-migration-rate-is-5.7" class="level3">
<h3 class="anchored" data-anchor-id="the-migration-rate-is-5.7">The migration rate is 5.7%</h3>
<p>The migration rate is the share of Malaysia-born persons who currently reside outside Malaysia. Malaysia’s population was 32.6 million in 2021, and with 1.85 million residing abroad, the migration rate is 5.7%.</p>
<p>It’s important to bear in mind that the numerator of the migration rate is a <a href="https://en.wikipedia.org/wiki/Stock_and_flow">stock, not a flow</a>. This context is often not provided in the media.</p>
<p>In simpler terms, we don’t have good numbers on who moves where and when. All we know is who is where at a given time.</p>
</section>
<section id="the-migration-rate-is-above-the-global-average" class="level3">
<h3 class="anchored" data-anchor-id="the-migration-rate-is-above-the-global-average">The migration rate is above the global average</h3>
<p>It’s commonly cited that Malaysia’s migration rate is almost double the global migration rate. However, our migration rate is not out of line with neighbouring countries.</p>
<p>In fact, Malaysia’s migration rate is neck-to-neck with Singapore.</p>
<p><img src="https://www.philipscurve.com/images/clipboard-1309878859.png" class="img-fluid"></p>
</section>
<section id="more-and-more-people-are-migrating-abroad" class="level3">
<h3 class="anchored" data-anchor-id="more-and-more-people-are-migrating-abroad">More and more people are migrating abroad</h3>
<p>Perhaps - yes, the migration rate has risen from 5.6% (2010) to 5.7% (2020), but the rate of growth of the number of Malaysian-born persons abroad has slowed:</p>
<p><img src="https://www.philipscurve.com/images/clipboard-566296810.png" class="img-fluid"></p>
<p>So yes, the number of emigrants may be rising, but at a decreasing (even plateauing) rate.</p>
<p>If we were to use the citizen population as the denominator instead, the migration rate would in fact decline from 6.34% (2015) to 6.25% (2020).</p>
</section>
<section id="brain-drain-vs-brain-gain" class="level3">
<h3 class="anchored" data-anchor-id="brain-drain-vs-brain-gain">Brain drain vs brain gain</h3>
<p>Concerns about brain drain ignore the realities of human capital in the 21st century, where people’s skills have become increasingly niche and may not be in demand in local markets.</p>
<p>As a developing economy, there may not be immediate demand for niche skillsets in Malaysia. In a globalised world, there’s no harm in Malaysians leaving the country to workplaces that are in need of their skillsets, and returning once demand for their skillsets has developed here, in what’s termed <a href="https://www.knomad.org/sites/default/files/2022-11/knomad_paper_46_brain_drain_brain_gain_and_its_net_effect_sandra_berger_november_2022.pdf">‘brain gain’</a>.</p>
<p>In fact, the observation that Singapore is by far the largest destination for Malaysian-born persons (rather than somewhere else across the world) suggests that Malaysians living abroad may not really want to leave for good.</p>
<p><img src="https://www.philipscurve.com/images/clipboard-1331457292.png" class="img-fluid"></p>
<p>However, if remote working is here to stay, I suppose concerns may eventually shift from brain drain to, say, tax avoidance.</p>
<hr>
<p>Check my work</p>
<ul>
<li><p><a href="https://ourworldindata.org/explorers/migration-flows?tab=table&amp;facet=none&amp;Select+a+country=Malaysia&amp;Outflow+or+Inflow=Emigrants%3A+Where+people+born+in+the+selected+country+moved+to&amp;country=~MYS" class="uri">https://ourworldindata.org/explorers/migration-flows?tab=table&amp;facet=none&amp;Select+a+country=Malaysia&amp;Outflow+or+Inflow=Emigrants%3A+Where+people+born+in+the+selected+country+moved+to&amp;country=~MYS</a></p></li>
<li><p>KNOMAD <a href="https://www.knomad.org/sites/default/files/2022-12/bilateral_migration_matrix_2021_latest.xlsx">2021 migration matrix</a></p></li>
<li><p><a href="https://open.dosm.gov.my/data-catalogue/population_malaysia">Malaysia population</a></p></li>
</ul>


</section>

 ]]></description>
  <guid>https://www.philipscurve.com/post/braindrain.html</guid>
  <pubDate>Wed, 29 May 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Temperatures 🌡️</title>
  <dc:creator>Philip Khor</dc:creator>
  <link>https://www.philipscurve.com/post/temp/temp.html</link>
  <description><![CDATA[ 





<p>Got so frustrated with the heat here in Penang I did a quick little fooling around with open-meteo.com data, ggplot2 and Inkscape. Started out with a simple facet plot in ggplot2 then tinkered around with the svg in Inkscape.</p>
<p><img src="https://www.philipscurve.com/post/temp/drawing.webp" class="img-fluid"></p>
<p><img src="https://www.philipscurve.com/post/temp/drawing_b.webp" class="img-fluid"></p>



 ]]></description>
  <guid>https://www.philipscurve.com/post/temp/temp.html</guid>
  <pubDate>Mon, 13 May 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Hello Julia</title>
  <dc:creator>Philip Khor</dc:creator>
  <link>https://www.philipscurve.com/post/hello-julia.html</link>
  <description><![CDATA[ 





<p>Not sure how I landed up browsing through <a href="https://livebook.manning.com/book/julia-for-data-analysis/">Julia for Data Science</a> and <a href="https://juliadatascience.io">Julia Data Science</a> this Saturday evening. Julia is a fascinating language, but I think the learning curve is a bit much for me. Tried making a simple line chart and it’s … pretty hard, although the syntax is quite interesting …</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">begin</span></span>
<span id="cb1-2">    <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">using</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">CSV</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">DataFrames</span></span>
<span id="cb1-3">    <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">using</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Downloads</span>: download</span>
<span id="cb1-4">    URL_DATA <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://storage.dosm.gov.my/cpi/cpi_2d.csv"</span></span>
<span id="cb1-5">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">download</span>(URL_DATA, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cpi_2d.csv"</span>)</span>
<span id="cb1-6">    df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> CSV.<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cpi_2d.csv"</span>, DataFrame)</span>
<span id="cb1-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span></code></pre></div>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">begin</span></span>
<span id="cb2-2">    <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">using</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">DataFramesMeta</span></span>
<span id="cb2-3">    <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">using</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">AlgebraOfGraphics</span></span>
<span id="cb2-4">    <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">using</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">CairoMakie</span></span>
<span id="cb2-5">    <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">using</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Dates</span>: Year</span>
<span id="cb2-6">    </span>
<span id="cb2-7">    <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">@rsubset</span>! df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>division <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"overall"</span></span>
<span id="cb2-8"></span>
<span id="cb2-9"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span></code></pre></div>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1">dat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">@chain</span> df <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">begin</span></span>
<span id="cb3-2">    <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">@select</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>date <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>lagged_index <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>index</span>
<span id="cb3-3">    <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">@rtransform</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>date <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>date <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Year</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rightjoin</span>(df; on <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>date)</span>
<span id="cb3-5">    <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">@rtransform</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>yoy <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>index <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>lagged_index <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>   </span>
<span id="cb3-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dropmissing</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>yoy)</span>
<span id="cb3-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span></code></pre></div>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">begin</span></span>
<span id="cb4-2">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_aog_theme!</span>()</span>
<span id="cb4-3">    plt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(dat) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mapping</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>date, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>yoy) </span>
<span id="cb4-4">    layers <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">visual</span>(Scatter) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">visual</span>(Lines)</span>
<span id="cb4-5">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">draw</span>(</span>
<span id="cb4-6">        plt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> layers,</span>
<span id="cb4-7">        axis <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (</span>
<span id="cb4-8">        ytickformat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"{:.0%}"</span>, </span>
<span id="cb4-9">        title <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Year-on-year change, consumer price index, Malaysia"</span>,</span>
<span id="cb4-10">        xlabel <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, </span>
<span id="cb4-11">        ylabel <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb4-12">    )</span>
<span id="cb4-13"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span></code></pre></div>
<p><img src="https://www.philipscurve.com/post/images/clipboard-466531566.png" class="img-fluid"></p>



 ]]></description>
  <guid>https://www.philipscurve.com/post/hello-julia.html</guid>
  <pubDate>Sun, 28 Apr 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>The Limited Local Benefits of Swiftonomics</title>
  <dc:creator>Philip Khor</dc:creator>
  <link>https://www.philipscurve.com/post/swift.html</link>
  <description><![CDATA[ 





<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This article was first published in the <a href="https://penangmonthly.com/article/21121/the-limited-local-benefits-of-swiftonomics">April 2024 issue</a> of Penang Monthly.</p>
</div>
</div>
<p>Taylor Swift, the queen of pop, transcends the realm of music. She’s a cultural force, a brand powerhouse, and according to Swifties in political leadership, a significant economic driver. Her relatable lyrics, narrative-driven albums, and social media engagement create a sense of community and shared experience. This fervent fanbase translates into dedicated concertgoers, enthusiastic merchandise buyers, and a loyal consumer base that fuels Swiftonomics.</p>
<p>Intriguingly, Taylor Swift’s critically acclaimed Eras Tour has sparked bad blood within ASEAN. Leaders across <a href="https://thediplomat.com/2024/03/singapores-pm-defends-taylor-swift-exclusivity-arrangement/">Thailand</a> and the <a href="https://thediplomat.com/2024/02/philippine-lawmaker-demands-answers-from-singapore-over-reported-taylor-swift-deal/">Philippines</a> have criticised Singapore for entering an agreement with Swift’s team to host concerts exclusively in Southeast Asia. Uncharacteristically, Malaysia’s traditionally concert-averse conservative bloc has joined the Swiftian gold rush, with <a href="https://mothership.sg/2024/03/why-malaysia-no-taylor-swift/">Bersatu leader Sasha Lyna Abdul Latiff</a> asking the Anwar administration to explain the outcome of past negotiations between the Malaysian government and Taylor Swift’s team during the Ismail Sabri administration.&nbsp;</p>
<p>ASEAN leaders wish Taylor Swift would schedule a concert in their respective countries, not purely out of fear of missing out. The Eras Tour is the first tour to <a href="https://www.aljazeera.com/features/2023/12/30/taylor-swift-and-the-strange-power-of">gross over USD 1 billion globally</a>, and its companion concert film, ‘Taylor Swift: The Eras Tour’, topped the record for <a href="https://variety.com/2024/film/news/taylor-swifts-the-eras-tour-highest-grossing-theatrical-concert-film-1235863956/#!">highest-grossing concert film</a> at over USD 261 billion, more than doubling the previous record held by ‘Justin Bieber: Never Say Never’ in 2011. The US leg of the Eras Tour generated USD 4.6 billion in direct consumer spending on expenses, including tickets, outfits, merchandise, food &amp; beverages and travel, according to <a href="https://www.questionpro.com/research/taylor-swift-study/">QuestionPro</a> estimates. At the same time, Economic Effects NET named the Eras Tour <a href="https://edition.cnn.com/2024/02/07/asia/taylor-swift-japan-tokyo-eras-tour-intl-hnk/index.html">Japan’s biggest-ever music event</a> by economic impact, generating USD 229.6 million across four Tokyo shows. Even so, Nobel laureate Paul Krugman wonders out loud, why doesn’t Taylor Swift <a href="https://www.nytimes.com/2023/06/20/opinion/taylor-swift-economics.html?action=click&amp;module=RelatedLinks&amp;pgtype=Article">earn more than she does</a>?&nbsp;</p>
<section id="look-what-you-made-singapore-do" class="level2">
<h2 class="anchored" data-anchor-id="look-what-you-made-singapore-do">Look What You Made Singapore Do</h2>
<p>Beyond short-term gains, Singapore bets on the Eras Tour and other mega-events to improve its allure to global entertainment acts, riding on the back of pent-up demand following the relaxation of COVID-19 public health restrictions across the globe. While the island-state may lack homegrown cultural credentials, it isn’t for lack of trying. In 2012, <a href="https://edition.cnn.com/2012/11/23/world/asia/singapore-emotions-gallup/index.html">Gallup</a> ranked Singaporeans as the most emotionless people globally. Now graced by the likes of Bruno Mars, Coldplay, and Ed Sheeran, Singapore is banking on their halo effect to <a href="https://www.bloomberg.com/opinion/articles/2024-01-07/taylor-swift-is-helping-singapore-ditch-its-dull-image">rehabilitate</a> its image into Asia’s <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7151847/">“events and entertainment capital”</a>.&nbsp;</p>
<p>The appeal of mega-events has historically been a double-edged sword. World leaders’ pleas for Taylor Swift’s patronage echo the race for Olympic host nations in not-too-distant memory. Concerns about environmental impact, fueled by Taylor Swift’s sizable carbon footprint from private jet travel, loom large. Estimates for 2022—during which Taylor Swift was not touring—suggest that her private jet travel produced a whopping <a href="https://carbonmarketwatch.org/2024/02/13/taylor-swift-and-the-top-polluters-department/">8,300 tonnes</a> of carbon emissions, equivalent to 1,800 (average) human beings in a year.&nbsp;</p>
<p>Moreover, it is unclear how the benefits of a Taylor Swift tour stop will be distributed within local communities. <a href="https://crossworks.holycross.edu/cgi/viewcontent.cgi?article=1103&amp;context=econ_working_papers">Matherson (2004)</a> argues that businesses reap the lion’s share of the profits from mega-events, which are unlikely to recirculate in the economy. Further, <a href="https://kpmg.com/au/en/home/media/press-releases/2024/02/taylor-swift-s-tour-won-t-bankroll-australia.html">KPMG</a> estimates that of the just over AUD 100 million profit that Taylor Swift is to earn from the Australian leg of the Eras Tour, the net impact of the tour on the Australian economy would be just a tenth of that: AUD 10.6 million, equivalent to 0.002% of Australia’s quarterly gross domestic product (GDP).&nbsp;</p>
</section>
<section id="i-knew-you-were-trouble-taylors-version" class="level2">
<h2 class="anchored" data-anchor-id="i-knew-you-were-trouble-taylors-version">I Knew You Were Trouble (Taylor’s Version?)</h2>
<p>Back home, concert enthusiasts in Malaysia have endured disappointment after disappointment. With Malaysia’s reputation for shutting down concerts in response to <a href="https://vulcanpost.com/835234/international-artist-ban-cancel-concert-performance-malaysia/">protests over performers’ stagewear</a>, the Eras Tour snub comes on the heels of opposition to Coldplay’s November 2023 Malaysia show over their <a href="https://www.theguardian.com/music/2023/nov/22/coldplay-concert-to-go-ahead-in-malaysia-amid-opposition-from-conservative-muslims">support for gender diversity</a>.&nbsp;</p>
<p>Former Minister of Youth and Sports <a href="https://www.theguardian.com/music/2023/nov/22/coldplay-concert-to-go-ahead-in-malaysia-amid-opposition-from-conservative-muslims">Syed Saddiq</a> characterised the cancellation of Malaysian Coldplay tour dates as missing “an economic lottery”, citing substantial spillovers in the transport and F&amp;B sector. Likewise, the <a href="https://www.facebook.com/alifemalaysia/posts/pfbid02hzM9wY5DwgYDVCh9wCrdnGmwiqqrciTXkHCmWdwyxF2x5hG7GFjqkgsiG5CDY3Dnl">Arts, Live Festival and Events Association</a> lamented the impact of protests on “our international business environment and reputation”, citing “millions in tourist income and benefit hotels, transportation, food and beverage, retail and more” resulting from Coldplay’s six sold-out shows in Singapore.&nbsp;</p>
<p>The uncertain business environment this has brought about bodes poorly for the local entertainment industry. Singapore’s successful efforts in ensuring a Swift landing must be viewed in light of its <a href="https://www.bloomberg.com/opinion/articles/2024-01-07/taylor-swift-is-helping-singapore-ditch-its-dull-image">historical disadvantage in homegrown talent</a>, in which Malaysia arguably has the upper hand. However, multiple factors in Malaysia threaten to suppress local cultural dynamics. The allure of dominant international acts such as Taylor Swift overshadows the real problems faced by local Malaysian artists, <a href="https://asia.nikkei.com/Editor-s-Picks/Tea-Leaves/Malaysia-highlights-disconnect-in-approach-to-popular-culture">constrained</a> as they are by shifting goalposts.</p>
<p>It is of little comfort that much of the purported spillover effects of mega-events are, more often than not, an exaggeration. Economically, Malaysia has little to lose beyond the creative economy, which contributes <a href="https://www.malaymail.com/news/malaysia/2021/10/04/creative-industry-contributed-rm29.4b-to-gdp-in-2019-says-deputy-minister/2010634">just under 2% of GDP (2019)</a>, if it resists the Taylor Swift FOMO plaguing the ASEAN region. For any administration in power, the uncertain economic benefits are not worth incurring confrontation from religious fundamentalists. The prospect of Malaysia becoming a regional destination for megastars, as Singapore aspires to be, is politically infeasible.</p>
</section>
<section id="shake-it-off" class="level2">
<h2 class="anchored" data-anchor-id="shake-it-off">Shake it off</h2>
<p>While some might pine for the Taylor Swift FOMO sweeping the region, it’s crucial to remember the uncertain economic benefits of mega-events. Mega-events will likely have a limited trickle-down effect, with businesses often reaping the lion’s share of profits that rarely reach local communities.</p>
<p>Instead of chasing fleeting trends, Malaysia should foster its rich cultural tapestry. By supporting and empowering local artists and creating a stable and inclusive environment for the arts to flourish, Malaysia can carve its unique niche in the region’s cultural landscape, one that transcends the allure of international megastars.</p>


</section>

 ]]></description>
  <guid>https://www.philipscurve.com/post/swift.html</guid>
  <pubDate>Fri, 26 Apr 2024 00:00:00 GMT</pubDate>
  <media:content url="https://penangmonthly.com/storage/19675/27086749_l_normal_none.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>My approach to Covid-19 in 2024</title>
  <dc:creator>Philip Khor</dc:creator>
  <link>https://www.philipscurve.com/post/covid24.html</link>
  <description><![CDATA[ 





<p>Four years into the pandemic, my refusal to align myself with the rest of society sleepwalking into a replay of 2019 norms of work and life has set me back for years personally and professionally. Many parties are trying to hoodwink the public into thinking that the pandemic is over in pursuit of short-term economic gain, while practically ensuring long-term economic and health catastrophe across the globe. Despite policymakers, public intellectuals and journalists’ attempt to wish the pandemic away, the Covid-19 pandemic remains, in 2024, a clear and present danger to public health.</p>
<section id="not-the-post-covid-youre-thinking-of" class="level2">
<h2 class="anchored" data-anchor-id="not-the-post-covid-youre-thinking-of">Not the post-Covid you’re thinking of</h2>
<p>While the public health emergency may have sunset, what has not is how 2020 marked a pivotal turning point in the science of disease transmission. Concerns about the air extend to more than just covid. Every pathogen that can transmit through air droplets is implicated, including rapidly spreading pathogens like measles and future novel airborne pathogens.</p>
<p>Early on in the pandemic, aerosol engineer Lindsey Marr wondered why a January 2020 article in the New York Times communicated that coronaviruses travelled shorter distances than viruses like measles, when her prior work on the flu virus suggested that SARS-Cov2 should be treated like any other airborne pollutant. Subsequent research about airborne transmission provided an explanation for bizarre superspreader events that couldn’t be explained by the widely accepted idea that surface transmission was the dominant route for transmission of diseases like covid-19, such as how covid-19 could spread across a room despite the then-accepted idea that airborne droplets travel no more than 2 metres.</p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/LKVdL3Wjv-I" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<p>The simple implication of the science of airborne pathogens tells us is that in a ‘post-Covid’ society, <a href="https://iris.who.int/bitstream/handle/10665/376496/9789240089181-eng.pdf">the air must be cleaned</a> Unlike vaccines, cleaning the air is a variant-proof solution. Moreover, there are clear co-benefits of cleaning the air: a <a href="https://www.nytimes.com/2024/03/19/climate/air-pollution-pm25.html?smid=nytcore-android-share">worldwide study</a> reveals that short-term exposure to fine particulate matter (PM2.5) contributes to roughly 1 million premature deaths annually. I am fortunate to be in Asian society where people have generally fallen in line with the use of high-quality masks even-as vital protection against disease, but it’s anyone’s guess how long it’ll last.</p>
<p>No thanks to incoherent public health messaging, societal norms do not reflect any understanding of the airborne route of disease transmission, from masks off for photos to indoor meals, and now with everyone ‘forgetting’ Covid-19, masks off altogether. At the height of the pandemic, the WHO and other public health agencies have consistently failed to acknowledge the prominence of the airborne route for transmission of SARS-Cov2. Up until very recently, local and international health agencies have consistently placed recommendations for hand hygiene above air hygiene measures in public health communication.</p>
<p>To the credit of the public health authorities, there has been a quiet shift in their position on the importance of cleaning indoor air. The new CDC recommendations stress the importance of air filtration and ventilation, and as early as 2021 Malaysia’s DOSH has issued air quality guidelines for commercial and residential settings. Yet thanks to public health authorities dragging their feet on acknowledging the science at the height of the pandemic, people have abdicated their responsibilities to mitigate airborne infection altogether, resulting in fundamentally unsafe public spaces. Consequently, <a href="https://www.nbcnews.com/health/health-news/health-workers-fear-s-profits-protection-cdc-revisits-airborne-transmi-rcna143663">health authorities in the US</a> have watered down recommendations to align with what society can accept, even when the science dictates otherwise.</p>
<p>Even though novel solutions such as UV-C and C-R boxes have been developed to complement HEPA filters and other solutions, the general public has been hoodwinked into thinking that nothing can and should be done to reduce disease transmission.</p>
</section>
<section id="multi-system-consequences" class="level2">
<h2 class="anchored" data-anchor-id="multi-system-consequences">Multi-system consequences</h2>
<p>The pandemic thus far has been devastating to humanity. The Economist estimated the toll of the pandemic to be <a href="https://www.economist.com/graphic-detail/coronavirus-excess-deaths-estimates">35mil</a> up to March 2024, just over Malaysia’s total population. Estimates of life expectancy suggest that Covid-19 has resulted in a loss of life expectancy at birth of <a href="https://www.livescience.com/health/coronavirus/covid-pandemic-knocked-16-years-off-global-life-expectancy-study-finds">1.6 years</a>, the largest drop since the Second World War. The costs of the pandemic, however, stretch far beyond mortality. The narrow framing of the health consequences of Covid-19 in terms of hospitalisations and deaths has led policymakers to ignore the chronic phase of Covid disease, colloquially known as Long Covid.</p>
<p>Long Covid parallels Nassim Taleb’s description of ‘black-swan events’: low-likelihood, high-impact situations that are not often incorporated in people’s risk calculus. However, absent mitigation, the chances of contracting Long Covid would certainly not qualify as a black swan event. Estimates of the incidence of long-term complications from Covid infection range from 10-50% per infection. Moreover, Covid-19 isn’t subject to the same seasonality as the flu, with people contracting 2-3 infections a year.</p>
<p><img src="https://images.theconversation.com/files/545912/original/file-20230901-21-ebj1at.png?ixlib=rb-1.1.0&amp;q=45&amp;auto=format&amp;w=1000&amp;fit=clip" class="img-fluid" width="519"><br>
</p>
<p><a href="https://www.science.org/doi/10.1126/science.adl0867">Much has been documented</a> about the consequences suffered by Long Covid patients, some of them who may have contracted Covid despite not exhibiting symptoms. There is no known cure for the disease. Some experts describe Covid as “not a disease of the lungs at all” but rather a <a href="https://www.heart.org/en/news/2024/01/16/how-covid-19-affects-your-heart-brain-and-other-organs">“vascular and neurologic infection”</a>. Moreover, the cognitive consequences of Long Covid are striking, equivalent to <a href="https://www.theguardian.com/world/2023/jul/21/long-covid-brain-fog-ageing-10-years-study">10 years of aging</a>. It is bizarre that Covid-19 isn’t treated as a serious occupational hazard. Rather, the consequences are so dire and rampant, a Californian court opined that were it to be treated as the occupational hazard that it is, the court would be <a href="https://www.reuters.com/legal/workers-cant-sue-over-take-home-covid-calif-top-court-rules-2023-07-07/">brought to a standstill</a>. Health issues that have classically been understood as non-communicable diseases are now literally airborne, yet the consequences of that have barely registered among policymakers.</p>
<p>David Cutler published estimates of the economic cost of Long Covid at <a href="https://scholar.harvard.edu/files/cutler/files/long_covid_update_7-22.pdf">3.7 trillion USD</a>, or 17% of 2019 US GDP. In an online forum organised by a US-based insurer, he expressed that the magnitude of the problem is such that there is no amount of investment towards preventing and curing Long Covid that would not be worth it. Young people stand to lose the most from Long Covid with more life-years, children are not spared, with estimates suggesting some <a href="https://www.cbsnews.com/news/millions-kids-long-covid-study-symptoms-mother-searching-for-answers/">5.8 million children in the US suffer from Long Covid</a>.</p>
</section>
<section id="increased-threat-level" class="level2">
<h2 class="anchored" data-anchor-id="increased-threat-level">Increased threat level</h2>
<p>Vaccines play a vital role in reducing the incidence of Covid-19 infection, severe disease and death. however they do not prevent infection completely. Moreover, considering the rapid evolution of covid-19 and especially the lack of available updated vaccines in our part of the world, calling for covid-19 precautions to be lifted is beyond premature. It has been established that vaccine-induced immunity to Covid-19 drops sharply in <a href="https://time.com/6276552/covid-19-vaccine-immunity-wanes/">less than a year</a>, and it should be clear that <a href="https://www.heart.org/en/news/2022/08/22/covid-19-infection-poses-higher-risk-for-myocarditis-than-vaccines">vaccine-acquired immunity</a> is much safer than <a href="https://www.science.org/content/article/rare-cases-coronavirus-vaccines-may-cause-long-covid-symptoms">infection-acquired immunity</a>.</p>
<p>Some reassure us that we are not in 2021. We certainly are not: vaccines have not kept pace with the rapid mutation of Sars-Cov2. Malaysia has only had access to vaccines based on the 2020 strain of the virus thus far. Availability of current vaccines is limited.</p>
<p>Despite this, society has been lulled into a false sense of security powered by groupthink. But groupthink logic is counterproductive in an active pandemic: when less people take precautions that reduce the risk for other people, the higher the risk for everyone else. Complacency about airborne pathogens is widespread amid the complete abdication of airborne disease mitigations. Generations to come will suffer for public intellectuals and politicians’ willful ignorance to avoid footing the costs of the practical and sensible normalisation of air filtration and ventilation measures.</p>
</section>
<section id="the-wfh-no-brainer" class="level2">
<h2 class="anchored" data-anchor-id="the-wfh-no-brainer">The WFH no-brainer</h2>
<p>Despite the established science on airborne disease transmission, employers insist that employees infect each other with any variety of airborne pathogen anywhere from 3 to 5 days a week, on top of denying medical leave for Covid. To add insult to injury, thought leaders continue to normalise in-person, unmasked superspreader events, accelerating the spread and mutations of and beyond covid-19, without regard for how in-person events exclude geographically distinct communities from vital policy conversations.</p>
<p>RTO in an active pandemic is a marker of the devaluation of knowledge work: knowledge workers are being infantalised when employers tell them that they have to come in the office to be productive. It is no wonder that there’s barely a squeak about the knowledge economy, when the implied consensus of the public’s nihilistic approach to Covid is that cognitive ability no longer matters.</p>
<p>In addition to the potential to inflict long-term loss of health and life, the accelerating and looming threat of climate change makes it reckless to engage in activities that involve substantial, repeated travel considering the urgency of de-escalating emissions. WFH has been shown to <a href="https://www.washingtonpost.com/climate-solutions/2023/09/18/work-from-home-carbon-footprint/">cut over half of carbon emissions</a> relative to in-person work, and that doesn’t even include carbon-intensive work flights that could be conducted over an hour-long Zoom meeting. Thought leaders feign ignorance of how surface temperature records have been broken for each of the past 12 months, even as researchers continue to be stunned by ocean temperature measurements.</p>


</section>

 ]]></description>
  <guid>https://www.philipscurve.com/post/covid24.html</guid>
  <pubDate>Mon, 01 Apr 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>When Less Is More Expensive: The Trend of Shrinkflation</title>
  <dc:creator>Philip Khor</dc:creator>
  <link>https://www.philipscurve.com/post/shrinkflation.html</link>
  <description><![CDATA[ 





<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>First published in <a href="https://penangmonthly.com/article/20987/when-less-is-more-expensive-the-trend-of-shrinkflation">Penang Monthly (September 2023)</a>.</p>
</div>
</div>
<p>WANTAN MEE IS a classic dish in Penang. Simple and tasty, it is a safe pick if you are unsure of what to order when eating out. It is usually served with fried or boiled dumplings, or a mix of both. What differs among vendors are also how many dumplings are included in the dish; some “dumplings” are also nothing more than fried dough skin.</p>
<p>Penang hawker food gives the French a run for their money, and hawkers continue to beat expectations about how small portions can be. Penangites are penny-wise regarding hawker food, and the hawkers seem to have recognised this. Extraordinarily, the Butterworth Art Walk organised a RM2 mini-food festival, allowing patrons to savour “smaller portions of hawker food at lower prices”<sup>1</sup>.</p>
<p>Hock Khoon from Bukit Mertajam laments how Curry Mee used to come with many cockles and side ingredients. “Now it has shrunk a lot. They compensate with more noodles! Some don’t even add cuttlefish.” He also observes how much beef portions have decreased at a major Japanese food outlet in Penang, even as its prices have increased.</p>
<p>This phenomenon, where businesses maintain pricing while reducing the quantity or size of their products, is known as shrinkflation. Named by the Norwegian Language Council as the Word of the Year in 2022 (<em>Krympflasjon</em> in Norwegian), the word was first used in 2015 in its current meaning by economist, Pippa Malmgren. A portmanteau of the words “shrink” and “inflation”, shrinkflation has been referred to in the past as package downsizing, product downsizing and content reduction.</p>
<p>As of June 2023, the food component of Penang’s consumer price index (CPI) has risen by 12.9% since early 2020. In 2022 alone, food prices increased by 6% year-on-year, contributing to 1.8% of Penang’s inflation for the year, up from 0.3% in 2021. Prices for milk, cheese and eggs rose by 11% year-on-year in 2022 (2021: 2.6%), while meat prices increased by 10.5% (2021: 1%). As of now, food price inflation remains elevated across the world amid the Russia-Ukraine conflict, coupled with erratic weather patterns caused by a dangerous combination of climate change and El Nino. The Food and Agricultural Organisation of the United Nations (FAO) notes that lower dam levels in northern Peninsular Malaysia threaten to lower rice yields, while the National Water Service Commission (SPAN) has set up an El Nino “war room” to monitor dam levels.</p>
<p>Different parts of the world have been experiencing shrinkflation differently. In Nigeria, Domino’s launched a “smallie” pizza with just four slices. In Europe, <em>Bloomberg</em> reports that Hamburg’s consumer protection office received three to five times more than the usual number of complaints regarding shrinking product sizes. In Britain, <em>The Economist</em> reports that Cadbury’s Creme Eggs now come in packs of five instead of six.</p>
<p><strong>Top 10 items with the highest increase in price (January 2022 to July 2023).</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://penangmonthly.com/storage/18955/instastories.jpg" class="img-fluid figure-img"></p>
<figcaption>Source: PriceCatcher data from OpenDOSM, Department of Statistics Malaysia; author’s analysis.</figcaption>
</figure>
</div>
<section id="why-does-this-work" class="level2">
<h2 class="anchored" data-anchor-id="why-does-this-work"><strong>Why Does This Work?</strong></h2>
<p>To many economists, the idea that the economic man (<em>homo economicus</em>) would fall prey to the shrinkflation trick is preposterous. If consumers are rational, should they not respond to a traditional price increase like they would to a price increase disguised as smaller packaging? On the contrary, the market research firm, Nielsen<sup>2</sup>, claims that consumers respond half as much to a change in prices via downsizing versus a raw price increase, and evidence suggests that shrinkflation does fool consumers.</p>
<p>Some theorise that firms exploit consumers’ inattention, hoping that consumers will not notice the change in quantity at the same price, or perhaps firms try to avoid angering customers by raising prices. In “Does Peter Piper Pick a Package of Pepper Inattentively?” <sup>3</sup>, Ian Meeker finds that US consumers did not reduce their purchases in response to the shrinkflation of black pepper. Conversely, in Japan, evidence from store scanner data<sup>4</sup> suggests that consumers there do respond to shrinking product sizes.</p>
<p>For certain types of businesses, shrinkflation can be explained by using a pricing strategy known as quantum pricing, where there are significant gaps between prices, and the same prices are used across different types of products over time. Retailers design their products to fit a certain price, which explains why quality (and/or quantity) reduces over time. Aparicio and Rigobon <sup>5</sup> find that large retailers, notably Apple, Zara, H&amp;M, Ikea and Uniqlo, follow this strategy.</p>
<p><strong>Median price by premise type, Penang (January 2022 to July 2023).</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://penangmonthly.com/storage/18954/shrink1.jpg" class="img-fluid figure-img"></p>
<figcaption>Source: PriceCatcher data from OpenDOSM, Department of Statistics, Malaysia.</figcaption>
</figure>
</div>
</section>
<section id="what-can-we-do" class="level2">
<h2 class="anchored" data-anchor-id="what-can-we-do"><strong>What Can We Do?</strong></h2>
<p>Given how hard it is to track shrinkflation, consumers have taken matters into their own hands in some parts of the world. A Japanese consumer, Masayuki Iwasa, created a website to track shrinkflation — www.neage.jp — which monitors 400 goods and services. In the US, Edgar Dworsky, founder of consumer advocacy site mouseprint.org, has been cited in the <em>New York Times</em> as the only person documenting shrinkflation in the US.</p>
<p>The Malaysian Minister of Economy, Rafizi Ramli, has encouraged consumers to leverage Department of Statistics’ (DOSM) data to compare price differences across premises using the KitaJaga app. However, the items covered are fairly limited and may not reflect changing consumer preferences. This raises the question of whether or not the Consumer Price Index (CPI), which is based on these data, provides a good view of general price changes.</p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Penang International Food Festival 2018 | Penang Free Sheet↩︎</p></li>
<li id="fn2"><p>What is product downsizing and how do you use it? - NIQ (nielseniq.com)↩︎</p></li>
<li id="fn3"><p>Meeker, Ian, Does Peter Piper Pick a Package of Pepper Inattentively? The Consumer Response to Product Size Changes (September 14, 2021). Available at SSRN: <a href="https://ssrn.com/abstract=3943201" class="uri">https://ssrn.com/abstract=3943201</a> or <a href="http://dx.doi.org/10.2139/ssrn.3943201" class="uri">http://dx.doi.org/10.2139/ssrn.3943201</a>↩︎</p></li>
<li id="fn4"><p>Imai, S. and Watanabe, T. (2014), Product Downsizing and Hidden Price Increases. Asian Economic Policy Review, 9: 69-89. <a href="https://doi.org/10.1111/aepr.12047" class="uri">https://doi.org/10.1111/aepr.12047</a>↩︎</p></li>
<li id="fn5"><p>Diego Aparicio &amp; Roberto Rigobon, 2023. “Quantum prices,” Journal of International Economics.↩︎</p></li>
</ol>
</section></div> ]]></description>
  <guid>https://www.philipscurve.com/post/shrinkflation.html</guid>
  <pubDate>Fri, 01 Sep 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Seasonality in decarbonisation</title>
  <dc:creator>Philip Khor</dc:creator>
  <link>https://www.philipscurve.com/post/decarb/decarb.html</link>
  <description><![CDATA[ 





<p>We need to decarbonise our economies ASAP, because global warming induced by human activity is bringing us dangerously close to breaching the limits of adaptability for human civilisation. One project that tracks that effort is a website called <a href="https://carbonmonitor.org/variation">Carbon Monitor</a> and boy are we not doing great:</p>
<p><img src="https://www.philipscurve.com/post/decarb/images/Screenshot 2023-08-31 172242.png" class="img-fluid"></p>
<p>Okay, in fairness, that’s more like mixed reviews. We’re making good progress in power (and somehow the residential sector?) but transport is looking bad, whether ground or air.</p>
<p>I’m no carbon analyst so I’m not sure what to do with the data, but I notice some interesting seasonality: across the world, emissions spike during the work week, but decline during weekends.</p>
<p><img src="https://www.philipscurve.com/post/decarb/images/carbonmonitor(4).png" class="img-fluid"></p>
<p>More interestingly, for ground transport, emissions consistently increase year-on-year during weekdays, and consistently decrease year-on-year during weekends:</p>
<p><img src="https://www.philipscurve.com/post/decarb/images/carbonmonitor.png" class="img-fluid"></p>
<p>Okay, not really so for the world, but have a look at the US and the EU:</p>
<p><img src="https://www.philipscurve.com/post/decarb/images/carbonmonitor(2).png" class="img-fluid"></p>
<p><img src="https://www.philipscurve.com/post/decarb/images/carbonmonitor(1).png" class="img-fluid"></p>
<p>and in case this was a fluke, I plotted the data by day of week:</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(readr)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(lubridate)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyr)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(here)</span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggthemes)</span>
<span id="cb1-8">carbon <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"carbonmonitor-global_datas_2023-08-31.csv"</span>), </span>
<span id="cb1-9">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col_types =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">date =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">col_date</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%d/%m/%Y"</span>)))</span>
<span id="cb1-10"></span>
<span id="cb1-11">carbon_plus1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> carbon <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">date =</span> date <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> lubridate<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">years</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb1-12"></span>
<span id="cb1-13">carbon <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb1-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(carbon_plus1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>timestamp),</span>
<span id="cb1-15">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"country"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"date"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sector"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb1-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">drop_na</span>(value.y) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb1-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">diff =</span> value.x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> value.y,</span>
<span id="cb1-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">day_of_week =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wday</span>(date, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">week_start =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb1-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reduce =</span> diff <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb1-21">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">year</span>(date) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2023</span>, sector <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ground Transport"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> day_of_week, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> reduce)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(country), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb1-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, </span>
<span id="cb1-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ground transport emissions have risen during workdays </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">but not the weekends"</span>, </span>
<span id="cb1-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Days with year-on-year decline in CO2 emissions by day of week</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Ground transport, Jan-Jul 2023"</span>,</span>
<span id="cb1-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data from Carbon Monitor"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_hc</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_hc</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkunica"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>, </span>
<span id="cb1-33">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#cbcbcd"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.philipscurve.com/post/decarb/decarb_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>It’s nice to see weekend emissions fall somewhat: perhaps rising EV adoption is finally having an effect? As for consistently higher weekday emissions, I think it may be reflective of the reversal of flexible work arrangements to in-person work in spite of the significant health risks that continue to be posed by Covid-19, and it looks like there are significant climate costs associated with this unfortunate phenomena which more than offset the significant progress that has been made in decarbonising our energy sources.</p>



 ]]></description>
  <guid>https://www.philipscurve.com/post/decarb/decarb.html</guid>
  <pubDate>Thu, 31 Aug 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>(Individual) tax rebates suck</title>
  <dc:creator>Philip Khor</dc:creator>
  <link>https://www.philipscurve.com/post/tax_rebates_suck.html</link>
  <description><![CDATA[ 





<p>If you’re one of the <a href="https://theedgemalaysia.com/article/cover-story-budget-2020-top-tax-bracket-raised-30-tin-number-proposed">16.5% of employees who pay taxes in Malaysia</a> you may be familiar with the many ways by which you can reduce your tax burden: tax reliefs. From purchases of computers to EPF contributions, there’s so many incentives that the government provides for you to save money, or even get some cash back in the process.</p>
<p>But wait a minute, you say. “I’m part of the 16%? The median income in Malaysia was RM5,873 a month in 2019<sup>1</sup>, and I’m barely there.” But well, most of you aren’t your own household. And if you’re a single-earner household, your median income turns out to be just RM2,988 (2019), well below the taxable threshold of around RM3,000 a month. The Salaries and Wages Report, which provides more frequent updates on wage trends, indicates a median income of RM2,250 in 2021.</p>
<p>So yeah, if you’re familiar with <a href="https://www.hasil.gov.my/media/gf1dooov/form_be2022_2.pdf">Borang BE</a> pat yourself on the back. You’re T20, you’ve made it as part of the socioeconomic elite.</p>
<p>Tax rebates are a great way for the government to claim to ‘fix’ problems without actually putting their money where their mouth is. There’s no real expense, just revenue forgone. But in truth, like a reverse Robin Hood, tax rebates steal from the poor to subsidise tax bills for the rich. So when a bunch of experts suggested <a href="https://www.thestar.com.my/news/nation/2023/07/07/ensuring-a-healthy-nest-egg">in the media</a> that tax rebates be used to encourage people to top up their EPF savings, I was rather unhappy.</p>
<p>To see why, let’s take a middle-of-the-road employee (‘Person A’) from a T20 household. In 2019, the median income per capita in a T20 household was RM3,854, or RM 46,248 a year<sup>2</sup>. For comparison, let’s take an individual (‘Person B’) that earns double that, say RM92,496. For the <a href="https://www.hasil.gov.my/en/individual/individual-life-cycle/how-to-declare-income/tax-rate/">year of assessment 2022</a>, Person A falls under the 8% tax bracket, whereas Person B falls under the 21% tax bracket. Ignoring all applicable tax reliefs, their tax payable would be as follows:</p>
<table class="caption-top table">
<tbody>
<tr class="odd">
<td>Person A</td>
<td>First 35,000</td>
<td>600</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>11,248 @ 8%</td>
<td>900</td>
<td><strong>1,500</strong></td>
</tr>
<tr class="odd">
<td>Person B</td>
<td>First 70,000</td>
<td>4,400</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>22,496 @ 21%</td>
<td>4,724</td>
<td><strong>9,124</strong></td>
</tr>
</tbody>
</table>
<p>Suppose that both Person A and B enjoy RM1,000 tax relief on top of the standard RM9,000 tax relief (for existing? idk). This reduces chargable income for each of these persons by RM10,000. However, for Person A, tax payable reduces by 800 (RM10,000 <img src="https://latex.codecogs.com/png.latex?%5Ctimes"> 8%), while for Person B tax payable reduces by RM2,100. This means the government has forgone 2.6 times more tax revenue for the richer Person B than for Person A, and makes tax deductions highly regressive: the rich benefit more than the poor.</p>
<p>Perhaps you object: Person B’s income means he contributes more to society, so he deserves additional relief proportionate to his contribution. Even by that logic, the government has forgone proportionately more revenue than Person B has earned.</p>
<p>Not to mention that the tax relief system is the bane of ratepayers’ existence: you are required to keep records for several years. Some of us approach the tax authorities for voluntary audits in fear of getting in trouble some point in the future if we’ve misunderstood the tax code.</p>
<p>Now, there may be a place for tax relief if the intention is to incentivise the rich to do certain pro-social things, for instance engage in risky investments to spur innovation, or even to purchase insurance, where their purchase of insurance could diversify risk pools and contribute to lower premiums. But it would be a lot more equitable to subsidise these behaviours directly. Insurance vouchers, for instance. Or topping up EPF contributions to a minimum, in the style of a <a href="https://mitsloan.mit.edu/ideas-made-to-matter/negative-income-tax-explained">negative income tax</a>.</p>
<p>If we expanded relief for voluntary contribution to the EPF, only the well-off and financially sound can afford to contribute voluntarily to the EPF at an amount significant enough to make a dent on their tax bill<sup>3</sup>. Not to lose sight of the fact that while we lobby the government to lower our tax bills, the median savings of EPF members has halved to <a href="https://www.bernama.com/en/business/news.php?id=2165052">RM8,100 in 2022 from RM16,600 pre-Covid</a>.</p>
<p>We need a real conversation about how to fund social security moving forward, lest retirement means poverty for the aging masses.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Disclaimer
</div>
</div>
<div class="callout-body-container callout-body">
<p>This article represents my own opinions and do not represent the opinions of my employer. I am not a tax professional and no part of this article should be taken as tax advice of any kind.</p>
</div>
</div>




<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>From the Household Income Survey, which is the source for all things B40/M40/T20.↩︎</p></li>
<li id="fn2"><p>See also <a href="http://web.usm.my/km/30(2)2012/KM%2030(2)%20ART%202%20(27-43).pdf" class="uri">http://web.usm.my/km/30(2)2012/KM%2030(2)%20ART%202%20(27-43).pdf</a>↩︎</p></li>
<li id="fn3"><p>Consider also that the EPF’s own analysis has characterised the large disparity between small and large depositors in the system as a problem. <a href="https://www.kwsp.gov.my/documents/20126/ddae99a2-bddd-4aee-4fbb-f85b1b3eddbf" class="uri">https://www.kwsp.gov.my/documents/20126/ddae99a2-bddd-4aee-4fbb-f85b1b3eddbf</a>↩︎</p></li>
</ol>
</section></div> ]]></description>
  <guid>https://www.philipscurve.com/post/tax_rebates_suck.html</guid>
  <pubDate>Sun, 09 Jul 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Gradient boosting?</title>
  <dc:creator>Philip Khor</dc:creator>
  <link>https://www.philipscurve.com/post/2022-04-20-gradient-boosting/</link>
  <description><![CDATA[ 





<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>There’s no shortage of machine learning hot takes on how the XGBoost gradient boosting framework continues to defy the <a href="https://machinelearningmastery.com/no-free-lunch-theorem-for-machine-learning/">no-free-lunch theorem</a> by being perhaps the most versatile learning algorithm across tabular data applications.</p>
<p>Gradient boosting (GBM) packages such as XGBoost sequentially train a series of <strong>shallow</strong> trees, resulting in an <strong>ensemble</strong> model. In other words,</p>
<blockquote class="blockquote">
<p>GBMs start with a single question, then add one question at a time. Training stops when adding another question would make the model too complex to explain or wouldn’t improve its performance.</p>
<p>(paraphrased from <a href="https://blogs.nvidia.com/blog/2020/09/23/ai-credit-risk-scotiabank/">NVIDIA press release</a>).</p>
</blockquote>
<p>A final GBM model is the sum of <img src="https://latex.codecogs.com/png.latex?B"> individual trees (‘learners’), trained up to the point of diminishing returns<sup>1</sup>:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AF(x)=%5Csum%5EB_%7Bb=1%7Df_b%5Cleft(x%5Cright)%0A"></p>
<p>This puts GBM squarely in the family of additive models<sup>2</sup> such as generalized additive models. GBMs sequentially nudge an initial weak model towards a strong model by consecutively <strong>adding</strong> simple models to an ensemble.</p>
<p>A gradient boosting model is:</p>
<ul>
<li><p><strong>trained using gradient descent</strong>. Similar to neural networks, the GBM learning algorithm optimizes the model sequentially using a gradient descent formulation. However, instead of optimizing individual model parameters, the GBM algorithm directly optimizes the model itself. This is sometimes known as <strong>gradient descent in functional space</strong>.</p></li>
<li><p><strong>a boosting model</strong>. In contrast with bagging learning algorithms such as random forests, boosting models take a different approach to model ensembling that uses simpler learners within an ensemble.</p>
<ul>
<li><p><strong>Bagging</strong> combines the wisdom of many individual learners to reduce variance (‘overfitting’). Resampling techniques ensure each tree in the ensemble is built differently. Learners in bagging ensembles are intentionally grown deep.</p></li>
<li><p><strong>Boosting</strong> combines weaker learners (‘models’) to form a strong overall model by sequentially improving (‘boosting’) the model’s performance using newer learners. This reduces model bias.</p></li>
</ul></li>
</ul>
</section>
<section id="learning-algorithm" class="level2">
<h2 class="anchored" data-anchor-id="learning-algorithm">Learning algorithm</h2>
<p>Training a GBM begins with initializing a simple model <img src="https://latex.codecogs.com/png.latex?f_0">, so that the model at iteration 0 is:</p>
<p><img src="https://latex.codecogs.com/png.latex?F_0(%0A%5Ctextbf%7Bx%7D%0A)=f_0(%5Ctextbf%7Bx%7D)"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?%5Ctextbf%7Bx%7D"> denotes the feature input vector. <img src="https://latex.codecogs.com/png.latex?f_0"> may be as simple as the average prediction. For a GBM modelling a single feature, the model may start off looking something like this<sup>3</sup>:</p>
<p><img src="https://www.philipscurve.com/post/2022-04-20-gradient-boosting/images/index.png" class="img-fluid"></p>
<p>The idea behind gradient boosting is to adjust the model sequentially to ‘fix’ the errors.</p>
<ul>
<li>Where the actual values are above <img src="https://latex.codecogs.com/png.latex?F_0">, the model should be adjusted <strong>upwards</strong>;</li>
<li>Where the actual values are below <img src="https://latex.codecogs.com/png.latex?F_0">, the model should be adjusted <strong>downwards</strong>;</li>
</ul>
<p>The boosting approach to solving this problem is to fit a model to the errors <img src="https://latex.codecogs.com/png.latex?%5Cepsilon%20=%20y-F(%5Ctextbf%7Bx%7D)"> at every iteration. At every iteration, we add a model of the errors to fix the previous model’s mistakes.</p>
<p><img src="https://www.philipscurve.com/post/2022-04-20-gradient-boosting/images/index3.png" class="img-fluid"></p>
<p>Stated differently, the model at the first boosting stage is the sum of the initial model <img src="https://latex.codecogs.com/png.latex?F_0"> and the model of the residuals <img src="https://latex.codecogs.com/png.latex?f_1">:</p>
<p><img src="https://latex.codecogs.com/png.latex?F_1(%5Ctextbf%7Bx%7D)=F_0(%5Ctextbf%7Bx%7D)+f_1(%5Ctextbf%7Bx%7D)">Intuitively, the residuals <img src="https://latex.codecogs.com/png.latex?%5Cepsilon"> indicate the <strong>direction</strong> in which the overall model should be nudged to get to the target value.</p>
<section id="gradient-descent" class="level3">
<h3 class="anchored" data-anchor-id="gradient-descent">Gradient descent?</h3>
<p>In practice, the residuals used to fit the learners are computed using the gradient of the loss function, and are also known as <strong>pseudoresiduals</strong>.</p>
<p>If we were to add the entirety of the model of the residuals <img src="https://latex.codecogs.com/png.latex?f_1">:</p>
<p><img src="https://latex.codecogs.com/png.latex?F_1(%5Ctextbf%7Bx%7D)=F_0(%5Ctextbf%7Bx%7D)+f_1(%5Ctextbf%7Bx%7D)"></p>
<p>then it may not be necessary to train for further iterations, since <img src="https://latex.codecogs.com/png.latex?y=F_0(%5Ctextbf%7Bx%7D)+%5Cepsilon"><sup>4</sup>. So we slow down training by adding only a fraction <img src="https://latex.codecogs.com/png.latex?%5Ceta"> of the learner:</p>
<p><img src="https://latex.codecogs.com/png.latex?F_1(%5Ctextbf%7Bx%7D)=F_0(%5Ctextbf%7Bx%7D)+%5Ceta%20f_1(%5Ctextbf%7Bx%7D)"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Ceta"> is known as the learning rate. It’s also known as a shrinkage parameter, since it shrinks the contribution of each learner to the ensemble.</p>
<p>Or more generally, for the <img src="https://latex.codecogs.com/png.latex?b">-th iteration:</p>
<p><img src="https://latex.codecogs.com/png.latex?F_b(%5Ctextbf%7Bx%7D)=F_%7Bb-1%7D(%5Ctextbf%7Bx%7D)+%5Ceta%20f_b(%5Ctextbf%7Bx%7D)"></p>
<p>Notice how this parallels with gradient descent for neural networks, where the direction of adjustment for the <img src="https://latex.codecogs.com/png.latex?j">-th <strong>model parameter</strong> <img src="https://latex.codecogs.com/png.latex?%5Ctheta_j"> is guided by the sign of the gradient:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Ctheta_%7Bj%7D%20=%5Ctheta_%7Bj%7D-%5Ceta%20%5Cfrac%7B%5Cdelta%7D%7B%5Cdelta%5Ctheta_j%7DJ(%5Ctheta)"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?J(%5Ctheta)"> refers to the loss function.</p>
<p>With gradient boosting, the direction of the gradient is used to adjust the <strong>overall model</strong> directly instead of individual model parameters.</p>
</section>
<section id="how-many-trees-then" class="level3">
<h3 class="anchored" data-anchor-id="how-many-trees-then">How many trees, then?</h3>
<p>It follows that lowering the learning rate <img src="https://latex.codecogs.com/png.latex?%5Ceta"> generally requires more learners to build an optimal model. By slowing the speed of adjustment, the learning algorithm is more likely to converge, but a large ensemble may be required for an optimal model<sup>5</sup>.</p>
<p>An approach to determining the number of learners required is known as <strong>early stopping</strong>. Additional learners are added until the point of diminishing returns, where there is no noticeable performance gain for adding new trees.</p>
<p>Since the model is trained iteratively, it is possible to score the model at every iteration. The <a href="https://xgboost.readthedocs.io/en/latest/python/python_api.html#xgboost.train"><code>early_stopping_rounds</code></a> argument in XGBoost checks the previous <code>early_stopping_rounds</code> for any improvement in the test score and trains the model for additional rounds only if improvements are observed.</p>
<p>Make sure to use separate sets of data for determining early stopping rounds and evaluating models.</p>
</section>
</section>
<section id="hyperparameters" class="level2">
<h2 class="anchored" data-anchor-id="hyperparameters">Hyperparameters</h2>
<p>A major challenge with tuning GBM models is knowing where to start from the large number of hyperparameters available. A great reference is <a href="https://sites.google.com/view/lauraepp/parameters">this table from Laurae++</a> which lists the mapping between hyperparameters in XGBoost and LightGBM.</p>
<p>Apart from learning rate and the number of trees, I group XGBoost hyperparameters into three categories:</p>
<table class="caption-top table">
<caption>Categories of GBM hyperparameters</caption>
<colgroup>
<col style="width: 68%">
<col style="width: 31%">
</colgroup>
<thead>
<tr class="header">
<th>Categories</th>
<th>Hyperparameters</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>Explicit regularization</strong></p>
<p>Directly adding cost for model complexity into the objective function</p></td>
<td>L1 (alpha) and L2 (lambda) regularization</td>
</tr>
<tr class="even">
<td><p><strong>Tree growth</strong></p>
<p>Control tree growth. I refer to some of these (maximum + pruning) as implicit regularization hyperparameters.</p></td>
<td><ul>
<li>Tree building method: “auto”, “exact”, “hist”</li>
<li>Tree growth method: “depthwise”, “lossguide”</li>
<li>Maximum depth, maximum leaves</li>
<li>Pruning: gamma, min_child_weight</li>
</ul></td>
</tr>
<tr class="odd">
<td><p><strong>Sampling</strong></p>
<p>Inspired by bagging/random forests</p></td>
<td>Row-wise and column-wise sampling</td>
</tr>
</tbody>
</table>
<p>For hyperparameter tuning, Optuna offers integration with <a href="https://github.com/optuna/optuna-examples/tree/main/xgboost/xgboost_integration.py">XGBoost</a>, <a href="https://github.com/optuna/optuna-examples/tree/main/catboost/catboost_pruning.py">Catboost</a> and <a href="https://github.com/optuna/optuna-examples/tree/main/lightgbm/lightgbm_integration.py">LightGBM</a> to incorporate early stopping.</p>
</section>
<section id="implementations" class="level2">
<h2 class="anchored" data-anchor-id="implementations">Implementations</h2>
<p>There’s at least 4 major implementations of GBMs:</p>
<ul>
<li>XGBoost</li>
<li>LightGBM</li>
<li>Catboost</li>
<li>sklearn.ensemble.HistGradientBoosting*</li>
</ul>
<p>There’s no shortage of articles comparing these different implementations.</p>
<p>These libraries (in particular XGBoost and LightGBM) do borrow ideas from each other. For instance, I list down the major differences between XGBoost and LightGBM below, however these LightGBM features are also available in XGBoost as options:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>XGBoost</th>
<th>LightGBM</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Tree building method</td>
<td>Exact: enumerate all split candidates</td>
<td>Features are discretized/binned beforehand (<a href="https://robotenique.github.io/posts/gbm-histogram/">hist</a>)</td>
</tr>
<tr class="even">
<td>Tree growth method</td>
<td>Depthwise/level-wise: trees are grown level by level.</td>
<td>Lossguide/leaf-wise: split based on best global loss</td>
</tr>
</tbody>
</table>
</section>
<section id="building-interpretable-gbms" class="level2">
<h2 class="anchored" data-anchor-id="building-interpretable-gbms">Building interpretable GBMs</h2>
<p>In some applications, it is necessary to consider additional measures to ensure the trustworthiness of a model.</p>
<section id="monotonic-constraints" class="level3">
<h3 class="anchored" data-anchor-id="monotonic-constraints">Monotonic constraints</h3>
<p>It may be useful to ensure that a GBM is constructed to align with certain ex ante expectations of how a feature is related to the target variable. Monotonic constraints ensure that a specified relationship is either strictly increasing or decreasing. See <a href="https://xgboost.readthedocs.io/en/stable/tutorials/monotonic.html" class="uri">https://xgboost.readthedocs.io/en/stable/tutorials/monotonic.html</a> for details.</p>
</section>
<section id="feature-interaction-constraints" class="level3">
<h3 class="anchored" data-anchor-id="feature-interaction-constraints">Feature interaction constraints</h3>
<p>In tree-based models, each additional level introduces interactions to the model. Interactions are where combinations of feature values matter to the model, and not just individual feature values. The additive structure of GBMs makes it possible to restrict interactions captured in a model by limiting the features used in each iteration.</p>
<ol type="1">
<li><a href="https://interpret.ml/docs/ebm.html">Explainable Boosting Machines</a> train on one feature at a time and incorporate automatic detection of interactions, such that the resulting model can be directly interpreted by summing up across all trees.</li>
<li><a href="https://xgboost.readthedocs.io/en/stable/tutorials/feature_interaction_constraint.html">XGBoost</a> allows users to specify which feature interactions are permitted. As an example, Scotiabank <a href="https://colab.research.google.com/github/wandb/examples/blob/master/colabs/boosting/Credit_Scorecards_with_XGBoost_and_W%26B.ipynb">transforms XGBoost models</a> trained with feature interaction constraints into a scorecard format for use in credit assessment.</li>
</ol>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>adapted from <a href="https://bradleyboehmke.github.io/HOML/gbm.html" class="uri">https://bradleyboehmke.github.io/HOML/gbm.html</a>↩︎</p></li>
<li id="fn2"><p><a href="https://explained.ai/gradient-boosting/L2-loss.html" class="uri">https://explained.ai/gradient-boosting/L2-loss.html</a>↩︎</p></li>
<li id="fn3"><p>Visualizations from <a href="https://github.com/madrury/boosting-presentation/blob/master/Boosting-Presentation-Galvanize.ipynb" class="uri">https://github.com/madrury/boosting-presentation/blob/master/Boosting-Presentation-Galvanize.ipynb</a>↩︎</p></li>
<li id="fn4"><p>Additionally, <img src="https://latex.codecogs.com/png.latex?%5Ceta=1"> may result in the error function spiralling about the minimum like so: <a href="https://stats.stackexchange.com/questions/282544/why-does-reducing-the-learning-rate-quickly-reduce-the-error/282555#282555" class="uri">https://stats.stackexchange.com/questions/282544/why-does-reducing-the-learning-rate-quickly-reduce-the-error/282555#282555</a>↩︎</p></li>
<li id="fn5"><p>This should not be taken as an indication of overfitting: the observation of double descent in neural networks suggests that extremely complex models do not necessarily overfit. However, limiting model complexity may be desirable for other reasons e.g.&nbsp;interpretability.↩︎</p></li>
</ol>
</section></div> ]]></description>
  <guid>https://www.philipscurve.com/post/2022-04-20-gradient-boosting/</guid>
  <pubDate>Wed, 20 Apr 2022 00:00:00 GMT</pubDate>
  <media:content url="https://www.philipscurve.com/post/2022-04-20-gradient-boosting/featured.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Nested cross-validation</title>
  <dc:creator>Philip Khor</dc:creator>
  <link>https://www.philipscurve.com/post/2020-10-24-nested-cross-validation/</link>
  <description><![CDATA[ 





<p>In <a href="../why-do-cross-validation/">Why do cross-validation</a>, I described cross-validation as a way of evaluating your modeling workflow from start to end to help you pick the appropriate model and avoid overfitting on your test set. No single model from the cross-validation process should actually be used as your final model<sup>1</sup>; cross-validation is merely a way to evaluate how well your modeling process works on repeated samples of your data, to get a better sense of how well your modeling choice works in the real world.</p>
<p>If you’re comparing estimator-to-estimator without tuning much, you’re at pretty low risk of overestimating model performance from model selection, so long as you don’t peek at your test set. Suppose I had three simple models:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.naive_bayes <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> GaussianNB</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.linear_model <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> LogisticRegression</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.ensemble <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> RandomForestClassifier</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.datasets <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> load_breast_cancer</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.model_selection <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> cross_val_score, KFold, GridSearchCV</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.svm <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> SVC</span>
<span id="cb1-7"></span>
<span id="cb1-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd </span>
<span id="cb1-9"></span>
<span id="cb1-10">X, y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> load_breast_cancer(return_X_y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>) </span>
<span id="cb1-11"></span>
<span id="cb1-12">nb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> GaussianNB()</span>
<span id="cb1-13">lr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> LogisticRegression()</span>
<span id="cb1-14">rf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> RandomForestClassifier()</span>
<span id="cb1-15"></span>
<span id="cb1-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># by default we get accuracy over 5-fold CV </span></span>
<span id="cb1-17">nb_scores <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cross_val_score(nb, X, y, scoring<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"accuracy"</span>)</span>
<span id="cb1-18">lr_scores <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cross_val_score(lr, X, y, scoring<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"accuracy"</span>)</span>
<span id="cb1-19">rf_scores <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cross_val_score(rf, X, y, scoring<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"accuracy"</span>)</span></code></pre></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(</span>
<span id="cb2-2">  [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GaussianNB"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LogisticRegression"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RandomForestClassifier"</span>], </span>
<span id="cb2-3">  [<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">round</span>(i, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> [nb_scores.mean(), lr_scores.mean(), rf_scores.mean()]]</span>
<span id="cb2-4">))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'GaussianNB': 0.939, 'LogisticRegression': 0.947, 'RandomForestClassifier': 0.953}</code></pre>
</div>
</div>
<p>From the scores above, it seems that RandomForestClassifier should perform best out-of-sample.</p>
<section id="what-about-hyperparameter-tuning" class="level2">
<h2 class="anchored" data-anchor-id="what-about-hyperparameter-tuning">What about hyperparameter tuning?</h2>
<p>I specifically chose these three estimators because they require minimal tuning. However, modern gradient boosting frameworks such as LightGBM and XGBoost have <a href="https://sites.google.com/view/lauraepp/parameters">a lot of hyperparameters to choose from</a>, and rarely do modellers have ways to guide hyperparameter choices.</p>
<p>Taking elastic net as an example, where the regularization term is a mix of L1 and L2 penalties:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Csum_%7Bi=1%7D%5E%7Bn%7D%20%5Cbig(%20y%5E%7B(i)%7D%20-%20%5Chat%7By%7D%5E%7B(i)%7D%20%20%5Cbig)%5E2%20+%20%5Clambda_1%20%5Csum%5E%7Bm%7D_%7Bj=1%7D%20w_%7Bj%7D%5E2+%20%5Clambda_2%20%5Csum%5E%7Bm%7D_%7Bj=1%7D%20%7Cw_j%7C%0A"> which is sometimes restated to establish a ‘mixing parameter’ <img src="https://latex.codecogs.com/png.latex?%5Calpha"> (e.g.&nbsp;glmnet):</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Csum_%7Bi=1%7D%5E%7Bn%7D%20%5Cbig(%20y%5E%7B(i)%7D%20-%20%5Chat%7By%7D%5E%7B(i)%7D%20%20%5Cbig)%5E2%20+%20%5Clambda%5Cleft%5B%20%5Cfrac%20%7B1-%5Calpha%7D%7B2%7D%5Csum%5E%7Bm%7D_%7Bj=1%7D%20w_%7Bj%7D%5E2+%5Calpha%20%5Csum%5E%7Bm%7D_%7Bj=1%7D%20%7Cw_j%7C%5Cright%5D%0A"></p>
<p>The choice between L1 and L2 regularization can be guided by our hypotheses of how the feature set affects the target. For instance, if many features do not affect the target, a higher mix of L1 penalty may be more appropriate, whereas if each feature contributes a little to the target, the L2 penalty would be more appropriate. However, it is not clear how to pick the regularization term <img src="https://latex.codecogs.com/png.latex?%5Clambda">.</p>
</section>
<section id="grid-search" class="level2">
<h2 class="anchored" data-anchor-id="grid-search">Grid Search</h2>
<p>The standard response to this is to perform a grid search on your hyperparameters. In scikit-learn, this can be done by fitting a GridSearchCV object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">parameters <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'kernel'</span>:(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'linear'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rbf'</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C'</span>:[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]}</span>
<span id="cb4-2">svc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> SVC()</span>
<span id="cb4-3">clf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> GridSearchCV(svc, parameters)</span>
<span id="cb4-4">clf.fit(X, y)</span></code></pre></div>
<div class="cell-output-display">
<style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GridSearchCV(estimator=SVC(),
             param_grid={'C': [1, 10], 'kernel': ('linear', 'rbf')})</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox"><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">GridSearchCV</label><div class="sk-toggleable__content"><pre>GridSearchCV(estimator=SVC(),
             param_grid={'C': [1, 10], 'kernel': ('linear', 'rbf')})</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox"><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">estimator: SVC</label><div class="sk-toggleable__content"><pre>SVC()</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox"><label for="sk-estimator-id-3" class="sk-toggleable__label sk-toggleable__label-arrow">SVC</label><div class="sk-toggleable__content"><pre>SVC()</pre></div></div></div></div></div></div></div></div></div></div>
</div>
</div>
<p>What does GridSearchCV do? Going to the scikit-learn documentation:</p>
<blockquote class="blockquote">
<p>It is possible and recommended to search the hyper-parameter space for the best cross validation score.</p>
</blockquote>
<p>and …</p>
<blockquote class="blockquote">
<p>exhaustively generates candidates from a grid of parameter values specified with the param_grid parameter</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">params_df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(clf.cv_results_[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"params"</span>])</span>
<span id="cb5-2">result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame({key: value <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> key, value <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> clf.cv_results_.items() <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> key.startswith(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"split"</span>)})</span>
<span id="cb5-3">res <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.concat([params_df, result], axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
</div>
<p>Essentially:</p>
<ol type="1">
<li><p>You construct a grid of hyperparameter values:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>C</th>
<th>kernel</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>linear</td>
</tr>
<tr class="even">
<td>1</td>
<td>rbf</td>
</tr>
<tr class="odd">
<td>10</td>
<td>linear</td>
</tr>
<tr class="even">
<td>10</td>
<td>rbf</td>
</tr>
</tbody>
</table></li>
<li><p>you perform a 5-fold cross validation, building a model on each combination of 4 of the 5 folds and evaluating the model on the remaining fold:</p>
<div class="cell">
<div class="cell-output-display">
<div id="hamjlnbvkl" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#hamjlnbvkl .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hamjlnbvkl .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hamjlnbvkl .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#hamjlnbvkl .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hamjlnbvkl .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hamjlnbvkl .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hamjlnbvkl .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hamjlnbvkl .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hamjlnbvkl .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hamjlnbvkl .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hamjlnbvkl .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hamjlnbvkl .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hamjlnbvkl .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#hamjlnbvkl .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hamjlnbvkl .gt_from_md > :first-child {
  margin-top: 0;
}

#hamjlnbvkl .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hamjlnbvkl .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hamjlnbvkl .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#hamjlnbvkl .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#hamjlnbvkl .gt_row_group_first td {
  border-top-width: 2px;
}

#hamjlnbvkl .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hamjlnbvkl .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#hamjlnbvkl .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#hamjlnbvkl .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hamjlnbvkl .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hamjlnbvkl .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hamjlnbvkl .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hamjlnbvkl .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hamjlnbvkl .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hamjlnbvkl .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hamjlnbvkl .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hamjlnbvkl .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hamjlnbvkl .gt_left {
  text-align: left;
}

#hamjlnbvkl .gt_center {
  text-align: center;
}

#hamjlnbvkl .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hamjlnbvkl .gt_font_normal {
  font-weight: normal;
}

#hamjlnbvkl .gt_font_bold {
  font-weight: bold;
}

#hamjlnbvkl .gt_font_italic {
  font-style: italic;
}

#hamjlnbvkl .gt_super {
  font-size: 65%;
}

#hamjlnbvkl .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#hamjlnbvkl .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#hamjlnbvkl .gt_indent_1 {
  text-indent: 5px;
}

#hamjlnbvkl .gt_indent_2 {
  text-indent: 10px;
}

#hamjlnbvkl .gt_indent_3 {
  text-indent: 15px;
}

#hamjlnbvkl .gt_indent_4 {
  text-indent: 20px;
}

#hamjlnbvkl .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead class="gt_col_headings">
<tr class="header">
<th id="C" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">C</th>
<th id="kernel" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">kernel</th>
<th id="fold0" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">fold0</th>
<th id="fold1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">fold1</th>
<th id="fold2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">fold2</th>
<th id="fold3" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">fold3</th>
<th id="fold4" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">fold4</th>
<th id="cv" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">cv</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="C">1</td>
<td class="gt_row gt_left" headers="kernel">linear</td>
<td class="gt_row gt_right" headers="fold0">0.947</td>
<td class="gt_row gt_right" headers="fold1">0.930</td>
<td class="gt_row gt_right" headers="fold2">0.974</td>
<td class="gt_row gt_right" headers="fold3">0.921</td>
<td class="gt_row gt_right" headers="fold4">0.956</td>
<td class="gt_row gt_right" headers="cv">0.946</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="C">1</td>
<td class="gt_row gt_left" headers="kernel">rbf</td>
<td class="gt_row gt_right" headers="fold0">0.851</td>
<td class="gt_row gt_right" headers="fold1">0.895</td>
<td class="gt_row gt_right" headers="fold2">0.930</td>
<td class="gt_row gt_right" headers="fold3">0.947</td>
<td class="gt_row gt_right" headers="fold4">0.938</td>
<td class="gt_row gt_right" headers="cv">0.912</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="C">10</td>
<td class="gt_row gt_left" headers="kernel">linear</td>
<td class="gt_row gt_right" headers="fold0">0.939</td>
<td class="gt_row gt_right" headers="fold1">0.939</td>
<td class="gt_row gt_right" headers="fold2">0.974</td>
<td class="gt_row gt_right" headers="fold3">0.947</td>
<td class="gt_row gt_right" headers="fold4">0.965</td>
<td class="gt_row gt_right" headers="cv">0.953</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="C">10</td>
<td class="gt_row gt_left" headers="kernel">rbf</td>
<td class="gt_row gt_right" headers="fold0">0.877</td>
<td class="gt_row gt_right" headers="fold1">0.921</td>
<td class="gt_row gt_right" headers="fold2">0.912</td>
<td class="gt_row gt_right" headers="fold3">0.956</td>
<td class="gt_row gt_right" headers="fold4">0.947</td>
<td class="gt_row gt_right" headers="cv">0.923</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></li>
<li><p>pick the best combination of hyperparameters<sup>2</sup></p></li>
<li><p><strong>REFIT</strong> the model on the WHOLE dataset<sup>3</sup>.</p></li>
</ol>
</section>
<section id="putting-the-tuning-in-hyperparameter-tuning" class="level2">
<h2 class="anchored" data-anchor-id="putting-the-tuning-in-hyperparameter-tuning">Putting the ‘tuning’ in hyperparameter tuning</h2>
<p>In practice, the data scientist probably does a little more than that. Recall that grid search exhausts the search space we specify. Since we specified two values for both <code>C</code> and <code>kernel</code>, the size of the grid is merely 4. A continuous search space is infinitely large :-(</p>
<section id="you-the-data-scientist" class="level3">
<h3 class="anchored" data-anchor-id="you-the-data-scientist">You, the data scientist</h3>
<p>You may not be satisfied with the predictive performance of the model we obtain, and as such you may try to search around the search space for a better hyperparameter value.</p>
<p>Suppose you start with</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">parameters <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'kernel'</span>:(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'linear'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rbf'</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C'</span>:[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]}</span></code></pre></div>
<p>find out RBF and C = 10 were selected by your search process, then proceed to run</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1">parameters <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'kernel'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rbf'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C'</span>:[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>]}</span></code></pre></div>
<p>hoping to get better performance.</p>
<p>The problem is that you are almost certain to get better performance, since you are optimizing for the same cross-validation scheme. We’ve violated the rule that cross-validation is just for evaluation, and inadvertently used it for optimizing our model!</p>
</section>
<section id="wait-what-just-happened" class="level3">
<h3 class="anchored" data-anchor-id="wait-what-just-happened">Wait … what just happened?</h3>
<p>To see why this is an issue, let’s simplify this problem a little by substituting cross-validation with a validation set approach. Suppose you used a train-validation split on your data and used the test score to guide your hyperparameter choice. And suppose our results looked a little like:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>C</th>
<th>kernel</th>
<th>test score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>linear</td>
<td>.95</td>
</tr>
<tr class="even">
<td>1</td>
<td>rbf</td>
<td>.91</td>
</tr>
<tr class="odd">
<td>10</td>
<td>linear</td>
<td>.96</td>
</tr>
<tr class="even">
<td>10</td>
<td>rbf</td>
<td>.90</td>
</tr>
</tbody>
</table>
<p>Now you know that 10 and linear are optimal, so you search around the vicinity of C = 10.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>C</th>
<th>kernel</th>
<th>test score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>8</td>
<td>linear</td>
<td>.92</td>
</tr>
<tr class="even">
<td>9</td>
<td>linear</td>
<td>.93</td>
</tr>
<tr class="odd">
<td>10</td>
<td>linear</td>
<td>.96</td>
</tr>
<tr class="even">
<td>11</td>
<td>linear</td>
<td>.97</td>
</tr>
</tbody>
</table>
<p>This has muddied the train-evaluation distinction. We ‘train’ our model using our observations for the evaluation set. You’d be hacking the test set for the best score, and the test score loses its efficacy as an indicator of your model’s performance. We will choose the hyperparameter that performs best on the test set, but its generalizability is questionable.</p>
</section>
<section id="can-cross-validation-save-us" class="level3">
<h3 class="anchored" data-anchor-id="can-cross-validation-save-us">Can cross-validation save us?</h3>
<p>Using cross-validation may not be enough. Suppose we had cross-validation split 1 with the following evaluation scores:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>C</th>
<th>kernel</th>
<th>cross-validated</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>linear</td>
<td>.95</td>
</tr>
<tr class="even">
<td>1</td>
<td>rbf</td>
<td>.91</td>
</tr>
<tr class="odd">
<td>10</td>
<td>linear</td>
<td>.96</td>
</tr>
<tr class="even">
<td>10</td>
<td>rbf</td>
<td>.90</td>
</tr>
</tbody>
</table>
<p>and again searched around the vicinity of C = 10:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>C</th>
<th>kernel</th>
<th>cross-validated</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>8</td>
<td>linear</td>
<td>.92</td>
</tr>
<tr class="even">
<td>9</td>
<td>linear</td>
<td>.93</td>
</tr>
<tr class="odd">
<td>10</td>
<td>linear</td>
<td>.96</td>
</tr>
<tr class="even">
<td>11</td>
<td>linear</td>
<td>.97</td>
</tr>
</tbody>
</table>
<p>you would be selecting the hyperparameters that are optimal for the cross-validation setup, since the hyperparameter <em>optimization</em> process shares the same cross-validation setup as the hyperparameter <em>evaluation</em> process. This time, instead of hacking the test set, you’re hacking the cross-validation setup.</p>
<p>As a result, the cross-validation error you obtain from this process would be <strong>overoptimistic</strong>.</p>
</section>
</section>
<section id="nested-cv" class="level2">
<h2 class="anchored" data-anchor-id="nested-cv">Nested CV</h2>
<p>Nested CV tries to fix this problem by integrating both training and model selection as part of the model fitting procedure.</p>
<p><a href="https://www.biorxiv.org/content/10.1101/2019.12.31.891895v1.full"><img src="https://www.philipscurve.com/post/2020-10-24-nested-cross-validation/images/F1.large.jpg" title="Standard nested Cross-Validation (nCV)." class="img-fluid"></a></p>
<p><span class="citation" data-cites="parvandeh2020a">Parvandeh et al. (2020)</span></p>
<p>Nested CV may seem complicated, but bear with me for a while.</p>
<section id="vanilla-cv" class="level3">
<h3 class="anchored" data-anchor-id="vanilla-cv">Vanilla CV</h3>
<p>in nested CV, the model is inclusive of the hyperparameter search process, in particular the search space you specify for the hyperparameter search. Instead of cross-validating a set of hyperparameters, we want to benchmark the performance of a hyperparameter search process over K folds of the dataset. This brings us back to the standard cross-validation definition:</p>
<p><img src="https://www.philipscurve.com/post/2020-10-24-nested-cross-validation/images/index.png" class="img-fluid" width="628"></p>
<ol type="1">
<li>Train the hyperparameter search process on folds 2-5, then test on fold 1;</li>
<li>Train the hyperparameter search process on folds 1, 3-5, then test on fold 2;</li>
<li>Train the hyperparameter search process on folds 1-2, 4-5, then test on fold 3;</li>
<li>Train the hyperparameter search process on folds 1-3, 5; then test on fold 4;</li>
<li>Train the hyperparameter search process on folds 1-4; then test on fold 5;</li>
</ol>
<p>and finally, average the performance on each of the test folds.</p>
</section>
<section id="bringing-in-hyperparameter-search" class="level3">
<h3 class="anchored" data-anchor-id="bringing-in-hyperparameter-search">Bringing in hyperparameter search</h3>
<p>Now, we would like the hyperparameter search process to be cross-validated as well. So within the hyperparameter search process, we define a different cross-validation configuration. In scikit-learn, this will look like:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">p_grid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb8-2">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C"</span>: [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>],</span>
<span id="cb8-3">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kernel"</span>: [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rbf"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"linear"</span>]</span>
<span id="cb8-4">}</span>
<span id="cb8-5">          </span>
<span id="cb8-6">svm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> SVC()</span>
<span id="cb8-7">inner_cv <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> KFold(n_splits<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, shuffle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb8-8">outer_cv <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> KFold(n_splits<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, shuffle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb8-9">clf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> GridSearchCV(estimator<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>svm, param_grid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>p_grid, cv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>inner_cv)</span>
<span id="cb8-10">nested_score <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cross_val_score(clf, X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>X, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>y, cv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>outer_cv)</span>
<span id="cb8-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(nested_score)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0.95804196 0.97183099 0.93661972 0.93661972]</code></pre>
</div>
</div>
<p>And once you’ve found a search space you’re happy with, refit the GridSearchCV object:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">clf.fit(X, y)</span></code></pre></div>
<div class="cell-output-display">
<style>#sk-container-id-2 {color: black;background-color: white;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GridSearchCV(cv=KFold(n_splits=4, random_state=None, shuffle=True),
             estimator=SVC(),
             param_grid={'C': [1, 10, 100], 'kernel': ['rbf', 'linear']})</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-4" type="checkbox"><label for="sk-estimator-id-4" class="sk-toggleable__label sk-toggleable__label-arrow">GridSearchCV</label><div class="sk-toggleable__content"><pre>GridSearchCV(cv=KFold(n_splits=4, random_state=None, shuffle=True),
             estimator=SVC(),
             param_grid={'C': [1, 10, 100], 'kernel': ['rbf', 'linear']})</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-5" type="checkbox"><label for="sk-estimator-id-5" class="sk-toggleable__label sk-toggleable__label-arrow">estimator: SVC</label><div class="sk-toggleable__content"><pre>SVC()</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-6" type="checkbox"><label for="sk-estimator-id-6" class="sk-toggleable__label sk-toggleable__label-arrow">SVC</label><div class="sk-toggleable__content"><pre>SVC()</pre></div></div></div></div></div></div></div></div></div></div>
</div>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1">clf.best_params_</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'C': 10, 'kernel': 'linear'}</code></pre>
</div>
</div>
<p>What is the consequence of this?</p>
<ol type="1">
<li><strong>Each of the folds may have a different set of hyperparameters.</strong> This is perfectly fine, as we are now trying to evaluate which hyperparameter search space/process works best, not which set of hyperparameters works best.</li>
<li>The final test set may have another set of hyperparameters.</li>
<li>When you eventually retrain on all the data you have, you may get a different set of hyperparameters! But that’s okay, because at the end of the day, we’re evaluating a process for fitting the model, not a set of hyperparameters.</li>
</ol>
</section>
</section>
<section id="what-next" class="level2">
<h2 class="anchored" data-anchor-id="what-next">What next?</h2>
<p><span class="citation" data-cites="cawley2010">Cawley and Talbot (2010)</span> note that high variance algorithms are more susceptible to overfitting in model selection. This should be troubling for machine learning practitioners, as we like our high-variance algorithms for being able to capture complexity that’s missed by traditional high-bias, low-variance algorithms like linear regression.</p>
<p>Nested CV can be computationally expensive, and it’s difficult to explain to stakeholders why you’d report a development sample score with different hyperparameters for each fold.</p>
<p>Some alternatives include:</p>
<ol type="1">
<li>regularization</li>
<li>early stopping</li>
<li>ensemble modelling</li>
<li>hyperparameter averaging.</li>
</ol>
<p>However, in the age of increasingly configurable gradient boosting frameworks such as XGBoost and CatBoost, it’s hard to see any one of these alternatives being sufficient to curb overfitting in model selection.</p>



</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-cawley2010" class="csl-entry">
Cawley, Gavin C., and Nicola L.C. Talbot. 2010. <span>“On over-Fitting in Model Selection and Subsequent Selection Bias in Performance Evaluation.”</span> <em>The Journal of Machine Learning Research</em> 11 (August): 20792107.
</div>
<div id="ref-parvandeh2020a" class="csl-entry">
Parvandeh, Saeid, Hung-Wen Yeh, Martin P. Paulus, and Brett A. McKinney. 2020. <span>“Consensus Features Nested Cross-Validation.”</span> <a href="https://doi.org/10.1101/2019.12.31.891895">https://doi.org/10.1101/2019.12.31.891895</a>.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>The unfortunate and unintended consequence of the wonderful <code>GridSearchCV()</code> class is that data scientists think that you can predict from a grid search process, and when they are pressed about where the ‘final model’ from a cross-validated process comes from, they may wonder, is it an ensemble model averaged across the folds, or are the hyperparameters averaged, or …????↩︎</p></li>
<li id="fn2"><p>presumably based on the average score between folds: this is unclear from the documentation but the numbers match up↩︎</p></li>
<li id="fn3"><p>this is the default, set as False if you do not want the refitting. In the case of multiple metrics, refit should be a string denoting the metric you want to use to find the best estimator.↩︎</p></li>
</ol>
</section></div> ]]></description>
  <guid>https://www.philipscurve.com/post/2020-10-24-nested-cross-validation/</guid>
  <pubDate>Sat, 24 Oct 2020 00:00:00 GMT</pubDate>
  <media:content url="https://www.philipscurve.com/post/2020-10-24-nested-cross-validation/featured.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Why do cross-validation?</title>
  <dc:creator>Philip Khor</dc:creator>
  <link>https://www.philipscurve.com/post/2020-10-11-why-do-cross-validation/2020-10-11-why-do-cross-validation.html</link>
  <description><![CDATA[ 





<p>In short, we do cross-validation to pick the right model. But what does that mean for our ‘final model’?</p>
<p>Let’s take a step back and motivate the train-test split approach (otherwise known as the <em>evaluation set approach</em>). Like cross-validation, we perform the evaluation set approach because we want to have some idea of how our model performs in the real world.</p>
<section id="the-evaluation-set-approach" class="level3">
<h3 class="anchored" data-anchor-id="the-evaluation-set-approach">The evaluation set approach</h3>
<p>A simple way to achieve this is to split our data so that the model is *trained* on one part of the data, and *evaluated* on the other part (‘holdout’). This is what we see at the start of most machine learning courses:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.philipscurve.com/post/2020-10-11-why-do-cross-validation/Screenshot 2020-10-11 105549.png" class="img-fluid figure-img"></p>
<figcaption>evaluation set approach</figcaption>
</figure>
</div>
<p>In Python, this is what we do when we call <code>train_test_split()</code> from <code>sklearn</code>:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.model_selection <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> train_test_split</span>
<span id="cb1-2">X_train, X_test, y_train, y_test <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> train_test_split(X, y, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>)</span></code></pre></div>
<p>for R users, using the <strong>tidymodels</strong> infrastructure, <strong>rsample</strong> can be used to split training and holdout sets:</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(rsample) </span>
<span id="cb2-2"></span>
<span id="cb2-3">car_split <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">initial_split</span>(mtcars)</span>
<span id="cb2-4">train_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">training</span>(car_split)</span>
<span id="cb2-5">test_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">testing</span>(car_split)</span></code></pre></div>
</section>
<section id="training-on-the-evaluation-set" class="level3">
<h3 class="anchored" data-anchor-id="training-on-the-evaluation-set">Training on the evaluation set</h3>
<p>Unfortunately for us, in practice, we use the holdout set <strong>a lot</strong> more than once. Today’s data scientist is spoiled for choice when it comes to algorithms: for gradient boosting alone, you have XGBoost, LightGBM, CatBoost, HistGradientBoosting, gbm etc., not to mention the numerous hyperparameters you have for any one algorithm. If you use the holdout set to guide your choice of hyperparameters, you are bound to overfit on your holdout set.</p>
<p>The no-free-lunch theorem further complicates this problem. Loosely speaking, the no-free-lunch theorem asserts that there is no One True Algorithm that has superior performance across all use cases. Given the above, the data scientist would have to test the algorithm multiple times to see which works best. With the evaluation set approach, this amounts to training on the holdout set.</p>
</section>
<section id="another-holdout-set" class="level3">
<h3 class="anchored" data-anchor-id="another-holdout-set">Another holdout set</h3>
<p>If you put this question up to the deep learning folks, they’ll provide you a seemingly simple solution: create two holdout sets. Pick the correct model on Holdout 1 (‘validation’), then evaluate the final model on Holdout 2 (‘holdout’):</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.philipscurve.com/post/2020-10-11-why-do-cross-validation/105453.png" class="img-fluid figure-img"></p>
<figcaption>train, validation, holdout</figcaption>
</figure>
</div>
<p>This may not be ideal sometimes because:</p>
<p>1. data is often limited: there may not be enough data for two holdout sets. Moreover, in cases where observations are time-sensitive, a TVH approach could reduce the generalizability of the chosen model if the time period of the shrinked training set is less relevant to the problem at hand.</p>
<p>2. Additionally, depending on the observations picked in validation/holdout, test error can be highly variable (see ISLR for details).</p>
</section>
<section id="k-fold-cross-validation" class="level3">
<h3 class="anchored" data-anchor-id="k-fold-cross-validation">K-fold cross-validation</h3>
<p>And so we move on to cross-validation, in hopes that we can get around this limited-data problem. This diagram may be familiar to some of you:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.philipscurve.com/post/2020-10-11-why-do-cross-validation/Screenshot 2020-10-11 105633.png" class="img-fluid figure-img"></p>
<figcaption>5-fold cross-validation</figcaption>
</figure>
</div>
<p>In (k-fold) cross-validation, we try to get at some semblance of generalization performance by resampling the development data. Slicing the development data into 5 folds, we train the data on 4 folds, and validate the resulting model on the remaining fold. We repeat this for each permutation of folds, and then average the validation score to obtain the cross-validated score.</p>
</section>
<section id="which-is-the-final-model" class="level3">
<h3 class="anchored" data-anchor-id="which-is-the-final-model">Which is the final model?</h3>
<p>While performing cross-validation, we have trained K models to evaluate our training procedure. Which should be the final model?</p>
<p><strong>None of the above!</strong> The purpose of cross-validation is merely to pick the correct procedure for fitting a model. Whether it be the algorithm or the hyperparameter search space, the purpose of cross-validation is to know what procedure works best for your data. The same procedure can be reused to re-fit the model on new data, and that should make up your final model.</p>
<blockquote class="blockquote">
<p>The purpose of cross-validation is model checking, not model building (<a href="https://stats.stackexchange.com/a/52277">StackExchange</a>)</p>
</blockquote>
<p>In fact, once you’re done with cross-validation and picked your final model, you can, and should, re-train your model-building procedure on all the data you have. There is no reason to drop the holdout set once the optimal procedure has been selected.</p>


</section>

 ]]></description>
  <guid>https://www.philipscurve.com/post/2020-10-11-why-do-cross-validation/2020-10-11-why-do-cross-validation.html</guid>
  <pubDate>Sun, 11 Oct 2020 00:00:00 GMT</pubDate>
  <media:content url="https://www.philipscurve.com/img/300px-Korsstygn_detalj.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>WSL2 and R</title>
  <dc:creator>Philip Khor</dc:creator>
  <link>https://www.philipscurve.com/post/wsl/</link>
  <description><![CDATA[ 





<p>Windows Subsystem for Linux (WSL) is a great way to run Linux software on your computer without dual-booting or starting over. For certain reasons, you may want to run R in Linux instead of Windows, and WSL can help.</p>
<p>As of the time of writing, the current version of WSL is WSL2.</p>
<section id="why-bother" class="level2">
<h2 class="anchored" data-anchor-id="why-bother">Why bother?</h2>
<p>That’s a good question. R does work fine with Windows, at least as far as I use it. And in general I think that would be the case for most people. Using R with Windows has the big advantage of having binaries on CRAN available for the latest version of packages. In comparison, Linux does not, however if you use RStudio Package Manager as a package source you’ll have access to <a href="https://packagemanager.rstudio.com/">package binaries for Linux</a>.</p>
<p>With R 4.0, compiling packages requires Rtools4.0, which requires <a href="https://cran.r-project.org/bin/windows/Rtools/">adding the Rtools home to the .Renviron file</a>. While I haven’t had problems with this setup, I’ve seen people facing issues on Twitter. Thank goodness we don’t have to install arbitrary Visual Studio dependencies like with some Python packages …</p>
<p>Essentially, I think you may want to consider using WSL2 with R if you anticipate having compilation issues for your packages on Windows that could be sidestepped by using Linux.</p>
<p>Downloading R binaries from conda is a great alternative, but conda’s pretty heavy and I wouldn’t recommend running R from conda in parallel with R, at least on Windows. This is because in my experience, the conda R instance looks for packages in the non-conda package library. This is something that’s <a href="https://github.com/conda-forge/r-base-feedstock/pull/65">being worked on</a>; in addition, if you install packages from GitHub, it’s probably not a great idea to mix that with your conda R library.</p>
</section>
<section id="okay-thats-great-but-i-want-to-keep-my-ide" class="level2">
<h2 class="anchored" data-anchor-id="okay-thats-great-but-i-want-to-keep-my-ide">Okay that’s great, but I want to keep my IDE!</h2>
<p>Running GUIs from WSL2 is a <a href="https://www.omgubuntu.co.uk/2020/05/run-linux-apps-on-windows-10-wsl-2">work-in-progress</a>. I think the most straightforward solution at this point is to use RStudio Server , which essentially allows you to use RStudio in a browser.</p>
<p>As with installing R on Windows, you’ll want to install R first. <a href="https://www.digitalocean.com/community/tutorials/how-to-install-r-on-ubuntu-20-04#step-2-%E2%80%94-installing-r-packages-from-cran">This tutorial</a> will help you install R using apt. Then, you’ll want to follow the instructions <a href="https://support.rstudio.com/hc/en-us/articles/360049776974-Using-RStudio-Server-in-Windows-WSL2">here</a> for installing RStudio Server.</p>
<p>Once you’re done, run</p>
<pre><code>sudo rstudio-server start</code></pre>
<p>in your WSL terminal.</p>
</section>
<section id="transferring-files" class="level2">
<h2 class="anchored" data-anchor-id="transferring-files">Transferring files</h2>
<p>That’s not too much of a problem actually. Once you start wsl, you can access your Linux file system using <code>//wsl$</code>.</p>


</section>

 ]]></description>
  <category>R</category>
  <guid>https://www.philipscurve.com/post/wsl/</guid>
  <pubDate>Thu, 27 Aug 2020 00:00:00 GMT</pubDate>
  <media:content url="https://www.philipscurve.com/post/wsl/featured.png" medium="image" type="image/png" height="96" width="144"/>
</item>
<item>
  <title>Charts can lie</title>
  <dc:creator>Philip Khor</dc:creator>
  <link>https://www.philipscurve.com/post/2019-10-14-charts-can-lie.html</link>
  <description><![CDATA[ 





<p>Data visualization is something we use to understand our data. Sure, it has some aesthetic function, but its primary purpose is to communicate what’s in the data.</p>
<p>Unfortunately, some Malaysian ministries just don’t get it. All the Minister wants is a pretty chart to put on Twitter.</p>
<p>It’s not cool if your chart’s designed to mislead, YB.</p>
<section id="graduate-marketability" class="level2">
<h2 class="anchored" data-anchor-id="graduate-marketability">Graduate marketability</h2>
<blockquote class="twitter-tweet blockquote">
<p lang="in" dir="ltr">
</p><p>Tahun lepas, kebolehpasaran siswazah kita berjaya mencapai sasaran 80.2%.<br><br>Tahun ini kebolehpasaran siswazah kita telah mencapai 82%.<br><br>Peningkatan drastik dua tahun kebelakangan ini ialah suatu kejayaan yang besar.<br><br>Terima kasih semua. <a href="https://t.co/I0gYSWRwTF">pic.twitter.com/I0gYSWRwTF</a></p>
<p></p>
<p>— Maszlee Malik (<span class="citation" data-cites="maszlee">@maszlee</span>) <a href="https://twitter.com/maszlee/status/1176332437305135104?ref_src=twsrc%5Etfw">September 24, 2019</a></p>
</blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>Dr.&nbsp;Maszlee wants to show that the graduate employability rate has risen from 2018 to 2019. Alright. Here’s the chart:</p>
<p><img src="https://pbs.twimg.com/media/EFMsHivWsAA6_J1?format=png&amp;name=900x900.png" class="img-fluid"></p>
<p>Let’s start with what graduate employability means. Honestly, I’ve no clue. The visual tells me nothing about that. Let’s do a quick Google search, shall we?</p>
<blockquote class="blockquote">
<p>SERDANG, 6 Mei – Kebolehpasaran graduan Universiti Putra Malaysia (UPM) menjangkau 82.2 peratus, iaitu yang tertinggi di kalangan institusi pengajian tinggi di negara ini.</p>
<p>Timbalan Naib Canselor (Hal Ehwal Pelajar dan Alumni) UPM, Prof.&nbsp;Dato’ Dr.&nbsp;Mohammad Shatar Sabran berkata 82.2 peratus daripada graduan UPM memperoleh pekerjaan dalam tempoh tiga bulan selepas konvokesyen mereka. https://upm.edu.my/news/kebolehpasaran_graduan_upm_822_peratus_tertinggi_di_kalangan_ipt-25091?L=bm</p>
</blockquote>
<p>Okay, so I presume it measures what percentage of graduates obtained jobs within three months of that convocation. Awesome. We should really just put that in the chart, because calling this “graduate employability” doesn’t tell us much..</p>
<p>Next, let’s think about how someone using the graphic will understand this chart.</p>
<p>The font for the numbers is quite large. But a key part of the visual is the length of the vertical ‘pillars’ supporting each of the ‘bubbles’.</p>
<p>I’m no expert in perception, but let’s say people take the length of the ‘pillars’ to represent the metric.</p>
<p>Surely people will think that the employability rate has improved a lot more than it has?</p>
<p>The increase of the rate from 2018 to 2019 was 2 percentage points. But we’re interested in the ratio of the 2019 to 2018 percentage. 82/80 implies an increase of 2.5%.</p>
<p>The line for 82% is 5 cm on my computer screen whereas the line for 80% is 2.3cm on my screen. That’s a ratio of 2.17 to 1, an increase of 117%.</p>
<p>Put simply, the graph exaggerates the change in the employability rate by almost 50 times.</p>
<p>The cognitive dissonance while processing the chart is stunning. Looking at the chart, I would have thought the Ministry made great progress, while in fact it’s just made a scratch.</p>
</section>
<section id="health-budgets" class="level1">
<h1>Health budgets</h1>
<blockquote class="twitter-tweet blockquote">
<p lang="in" dir="ltr">
</p><p>JUMLAH BAJET KESIHATAN<br>ALHAMDULILLAH!1<br><br>2019: RM28.68 bilion<br>2020: RM30.6 bil<br>% NAIK: 6.7%<br>KENAIKAN : RM1.92 bil<br><br>Bajet O.E:<br>2019: RM26.49 bil<br>2020: RM 27.9 bil<br>% NAIK : 5.3%<br>KENAIKAN: RM1.41 bilion<br><br>Bajet D.E:<br>2019: RM2.18 bil<br>2020: RM 2.7 bil<br>% NAIK : 23.8%<br>KENAIKAN: RM520 juta <a href="https://t.co/7A91JzkfKZ">pic.twitter.com/7A91JzkfKZ</a></p>
<p></p>
<p>— Dzulkefly Ahmad (<span class="citation" data-cites="DrDzul">@DrDzul</span>) <a href="https://twitter.com/DrDzul/status/1182591381023252481?ref_src=twsrc%5Etfw">October 11, 2019</a></p>
</blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>The Ministry of Finance raised the budget allocation for the Ministry of Health.</p>
<p><img src="https://pbs.twimg.com/media/EGloj0qUYAANBme?format=jpg&amp;name=small.png" class="img-fluid"></p>
<p>The height of the bars implies that the health budget in 2020 has doubled. This is clearly not the case, and even the graph says so: it states that the increase was by 6.7% (I calculated 5.5%, but it could be a rounding error).</p>
<p>That’s not even the best part. Notice that the bar for the operational budget, at 27.9 billion, is higher than the bar for the 2019 budget, at 29 billion. Apparently 27.9 billion is more than 29 billion.</p>
<p>Wow.</p>
</section>
<section id="impact-metrics" class="level1">
<h1>Impact metrics</h1>
<p>These two graphics are prime candidates for using impact metrics. I tried making something quick:</p>
<p><img src="https://www.philipscurve.com/img/graduate-employability.png" class="img-fluid"> <img src="https://www.philipscurve.com/img/health-budget.png" class="img-fluid"></p>
<p>If you ask me, that’s more honest and clear than what the YBs tweeted.</p>
</section>
<section id="thoughts" class="level1">
<h1>Thoughts</h1>
<p>I taught classes on data visualization at my previous role. And it pains me to see how data visualization standards are not prioritized in policy circles in Malaysia. I’ve seen more than enough dual axis charts, pie charts, 3D donut charts, etc.</p>
<p>This is not ideal. A policy professional’s role is to communicate information to the public. If your reports don’t account for best practices in data visualization, you are bound to confuse, if not mislead, your audience. We know, for instance, that pie charts are a bad choice of visualization, because humans find it difficult to tell quantities from angles as opposed to lengths.</p>
<p>Why? <a href="https://paldhous.github.io/ucb/2016/dataviz/week2.html">In the 80s</a>, Cleveland and McGill ran a series of experiments which established a hierarchy of which visual cues humans can perceive more accurately. In the case of pie charts, it is popularly believed that we perceive quantities by arc of each of the pie’s slices. This is why waffle charts should be the standard for displaying proportions of a whole: lengths are easier to perceive than angles.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://paldhous.github.io/ucb/2016/dataviz/img/class2_2.jpg" class="img-fluid figure-img"></p>
<figcaption>Cleveland and McGill’s hierarchy of perception of visual cues</figcaption>
</figure>
</div>
<p>We need to do better when it comes to data visualization in Malaysia, particularly for communicating public policy. Government departments need to prioritise effective communication over aesthetic value.</p>


</section>

 ]]></description>
  <guid>https://www.philipscurve.com/post/2019-10-14-charts-can-lie.html</guid>
  <pubDate>Mon, 14 Oct 2019 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Learning to sell data science</title>
  <dc:creator>Philip Khor</dc:creator>
  <link>https://www.philipscurve.com/post/learning-to-sell/</link>
  <description><![CDATA[ 





<blockquote class="blockquote">
<p>Half of your job, regardless of what that job is, is being able to sell your work. (<a href="https://vicki.substack.com/p/selling-data-science">source</a>)</p>
</blockquote>
<p>At GRID Inc., <a href="https://www.linkedin.com/pulse/3-things-i-learnt-deep-learning-computer-vision-janice-khor-ean-yee/?trackingId=KP8GSB%2FTReWsbNXNQdWPkQ%3D%3D">my colleague</a> and I were tasked to develop deep learning-based models to address client use cases as part of an internship programme. As a junior data scientist with practically no experience in deep learning, being tasked to develop deep learning systems was a daunting challenge.</p>
<p>But the biggest challenge of all wasn’t technical.</p>
<p>That’s not to say there weren’t difficult technical challenges to transitioning from delivering classes to a deep learning engineering role. Having to shift to working with Python and image data from my usual work processing numeric data in R was a steep learning curve, not to mention learning to <a href="https://drivendata.github.io/cookiecutter-data-science/#directory-structure">organize a data science project in Python</a>.</p>
<section id="relevance" class="level2">
<h2 class="anchored" data-anchor-id="relevance">Relevance</h2>
<p>The biggest challenge was to answer the question: <strong><em>how does this help the client</em></strong>?</p>
<p>You could have built a state-of-the-art model using the latest deep learning algorithms, with promising out-of-sample errors derived from a well-designed data partitioning strategy. But if the client isn’t convinced that it’s useful, you’re not going to get recurring business. The client may not understand the technical merits of your project: you’re going to have to convince them that it is technically sound without getting too absorbed in the details.</p>
<p>Moreover, even if you’re sharing to your own data science team, some members of your team may not be familiar with the domain you’re working in, and you’re going to have to make similar adjustments to your presentation/reporting to make sure it’s accessible to your audience.</p>
<p>Granted, our roles weren’t client-facing, but we were challenged to make the systems relevant to the client all the same. One way to do this is to develop or pick metrics that are relevant to the use case, to make sure the client can relate to what you’re talking about.</p>
<p>As an example, in the context of regression problems, I strongly prefer using metrics that summarize the distribution of errors, e.g.&nbsp;root mean squared error (RMSE) rather than R-squared. Putting aside the <a href="https://data.library.virginia.edu/is-r-squared-useless/">many other downsides of the R-squared</a>, its biggest drawback to me is its rather nuanced and commonly misunderstood definition. Reporting a metric like RMSE or MAPE (mean average percentage error) that’s in the same units as the outcome of interest is more straightforward and makes the metric more meaningful for the client.</p>
</section>
<section id="less-is-more" class="level2">
<h2 class="anchored" data-anchor-id="less-is-more">Less is more</h2>
<p>If you’re going to get your message across, there’s always going to be stuff you have to leave in the file drawer.</p>
<p>With my project, I had multiple performance metrics on hand. I was reluctant to leave the irrelevant ones out from the report, because I put in a lot of effort into developing the metric. However, I was met with confusion when I presented them all to my colleagues, and in hindsight I should have just left it out. (So much for having an understanding of sunk costs …)</p>
<p>In addition, you can’t go over every detail of your modelling work.</p>
<p>On the one hand, deep learning architectures are indeed complex. On the other hand, the architectures we know about are known to work out for a number of use cases. Going over details of the architectures used is generally just unnecessary, although highlighting key differences between architectures that make a difference to your model’s performance can help your audience to understand your thought process.</p>
<p>For instance, in deep learning-based object detection, there is a <a href="https://arxiv.org/abs/1611.10012">speed-accuracy trade-off</a> between region proposal network and regression-based architectures. This can be explained as a consideration in selecting the algorithm without going over implementation details.</p>
<p>tl;dr Give just enough detail: not more than necessary, but no less than necessary either.</p>
</section>
<section id="communication-is-key" class="level2">
<h2 class="anchored" data-anchor-id="communication-is-key">Communication is key</h2>
<p>I think data science people don’t talk enough about how important communication is. Which is why reading Vicki Boykis’ excellent blog post on <a href="https://vicki.substack.com/p/selling-data-science">selling data science</a> this morning (from which I got the quote above!) was so striking for me.</p>
<p>We certainly have some idea that communication is important. Data science wouldn’t have been as popular as it is now, if not for the proliferation of resources, whether it be blog posts, documentation, Twitter, GitHub repositories and the like.</p>
<p>When presenting modelling work, it’s tempting to go all <a href="https://www.youtube.com/watch?v=Iwpi1Lm6dFo">death by PowerPoint</a> and overwhelm your audience with all the information you have. But that’s not going to convince them that your model can drive business value.</p>
<p>I think data scientists have a lot to learn from the data visualization community, since our job involves communicating about data. For instance, being mindful of the visual hierarchy in your diagrams (example below) can help make your message a lot more impactful.</p>
<p><img src="https://www.philipscurve.com/img/0.png" class="img-fluid"></p>
</section>
<section id="conclusions" class="level2">
<h2 class="anchored" data-anchor-id="conclusions">Conclusions</h2>
<p>Now, that is not to say that programming and statistics skills aren’t important. I came out of this wishing I had better programming skills, and there’s no shortage of statistics and modelling techniques to be learned.</p>
<p>The good news: data science has <a href="https://www.predictionmachines.ai/">democratized prediction</a> with the free availability and active development of open-source tools, cheaper hardware and a vibrant online community. But we need to pay attention to how we communicate the business relevance of our work, because the glamour of opaque buzzwords and playing the benchmarks game can only take us so far.</p>


</section>

 ]]></description>
  <guid>https://www.philipscurve.com/post/learning-to-sell/</guid>
  <pubDate>Wed, 07 Aug 2019 00:00:00 GMT</pubDate>
  <media:content url="https://www.philipscurve.com/post/learning-to-sell/featured.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Link functions matter</title>
  <dc:creator>Philip Khor</dc:creator>
  <link>https://www.philipscurve.com/post/2019-07-14-link-functions-matter.html</link>
  <description><![CDATA[ 





<p>There’s a bit of a conversation on Twitter whether to use linear models or logistic models for estimating effect sizes in the case of binary response variables. I wondered if linear models can work for prediction problems with binary response variables, since there may be cases where the latent probability is linearly related to the features.</p>
<p>So I thought I’d do a little benchmark between different link functions for regression-based classifiers for the Titanic problem, based on the <code>tidymodels</code> packages.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(vroom)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(here)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(janitor)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(rsample)</span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(recipes)  </span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(stringr)</span>
<span id="cb1-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(broom) </span>
<span id="cb1-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(magrittr)</span>
<span id="cb1-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(yardstick)</span>
<span id="cb1-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tibble)</span>
<span id="cb1-12"></span>
<span id="cb1-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vroom</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"train.csv"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>() <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> titanic_train</span>
<span id="cb1-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vroom</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"train.csv"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>() <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> titanic_testing</span></code></pre></div>
</div>
<p>Preprocessing steps are taken from Megan Risdal’s R kernel on Kaggle, <a href="https://www.kaggle.com/mrisdal/exploring-survival-on-the-titanic">Exploring the Titanic Dataset</a>, with the major change being that I use bagging imputation instead of MICE imputation for the Age column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">recipe</span>(titanic_train) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">step_mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">survived =</span> survived, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">role =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"outcome"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">update_role</span>(pclass, age, sib_sp, parch, fare, </span>
<span id="cb2-4">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">new_role =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"predictor"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">step_mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">embarked =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(embarked), </span>
<span id="cb2-6">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sex =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(sex), </span>
<span id="cb2-7">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fsize =</span> parch <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> sib_sp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span id="cb2-8">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'(.*,)|</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">s|(</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">..*)'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, name),</span>
<span id="cb2-9">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_trim</span>(title), </span>
<span id="cb2-10">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fsize_d =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb2-11">           fsize <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"singleton"</span>, </span>
<span id="cb2-12">           fsize <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> fsize <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"small"</span>,</span>
<span id="cb2-13">           fsize <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"large"</span></span>
<span id="cb2-14">         ), </span>
<span id="cb2-15">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">role =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"predictor"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">step_impute_bag</span>(age, </span>
<span id="cb2-17">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">impute_with =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">imp_vars</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>passenger_id, </span>
<span id="cb2-18">                                        <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>name, </span>
<span id="cb2-19">                                        <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>ticket,</span>
<span id="cb2-20">                                        <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>cabin,</span>
<span id="cb2-21">                                        <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>survived)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">step_unknown</span>(title) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">step_mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(title), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"unknown"</span>, title)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">step_mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">child =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(age <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>),</span>
<span id="cb2-25">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mother =</span> sex <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"female"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> parch <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> age <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> title <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Miss"</span>, </span>
<span id="cb2-26">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">role =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"predictor"</span>)  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">step_other</span>(title, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">threshold =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">05</span>) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> rec</span>
<span id="cb2-28"></span>
<span id="cb2-29">trained_rec <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prep</span>(rec, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">training =</span> titanic_train)</span>
<span id="cb2-30">titanic_training <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bake</span>(trained_rec, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">new_data =</span> titanic_train)</span>
<span id="cb2-31">titanic_testing <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bake</span>(trained_rec, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">new_data =</span> titanic_testing)</span></code></pre></div>
</div>
<p>I then fit linear and non-linear models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">formula <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> survived <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> pclass <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> sex <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> age <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> sib_sp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> parch <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-2">     fare <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> embarked <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(title) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> fsize_d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> child <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> mother</span>
<span id="cb3-3">     </span>
<span id="cb3-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(formula, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> titanic_training) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> reg</span>
<span id="cb3-5"></span>
<span id="cb3-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glm</span>(formula, </span>
<span id="cb3-7">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> titanic_training, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"binomial"</span>) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> log_reg</span>
<span id="cb3-8"></span>
<span id="cb3-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glm</span>(formula, </span>
<span id="cb3-10">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> titanic_training, </span>
<span id="cb3-11">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">binomial</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">link =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"probit"</span>)) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> prob_reg</span>
<span id="cb3-12">   </span>
<span id="cb3-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glm</span>(formula, </span>
<span id="cb3-14">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> titanic_training, </span>
<span id="cb3-15">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">binomial</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">link =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cauchit"</span>)) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> cauch_reg</span></code></pre></div>
</div>
<p>These classifiers all have a common theme - they use an underlying regression model to estimate probabilities. The weakness of using a linear model for classification problems is that the probabilities can be less than 0 or more than 1, which defies the rules of probability. <a href="http://lenkiefer.com/2018/07/21/maybe-the-linear-probability-model-isn-t-all-bad/">Len Kiefer</a> explores <strong>trimmed OLS</strong> for estimating effect sizes, where we eliminate observations where the predicted probabilities are less than 0 or more than 1 first, then re-estimate OLS. The code for trimmed OLS are as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># trimmed OLS</span></span>
<span id="cb4-2">reg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">augment</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(.fitted <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> .fitted <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> out_of_bounds</span>
<span id="cb4-5"></span>
<span id="cb4-6">titanic_training <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames_to_column</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">var =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'.rownames'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anti_join</span>(out_of_bounds, </span>
<span id="cb4-9">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".rownames"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%$%</span></span>
<span id="cb4-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(formula, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> .) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> trimmed_ols</span></code></pre></div>
</div>
<p>And now time to evaluate. While the OLS models don’t perform as well here, the model using the Cauchit link function provides the highest accuracy score:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">eval <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(model, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">newdata =</span> titanic_testing, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type.predict =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>) {</span>
<span id="cb5-2">  multi_metric <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">metric_set</span>(accuracy, kap)</span>
<span id="cb5-3">  model <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">augment</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">newdata =</span> newdata, </span>
<span id="cb5-5">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type.predict =</span> type.predict) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pred_class =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.integer</span>(.fitted <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">multi_metric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(survived), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">estimate =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(pred_class))</span>
<span id="cb5-8">}</span>
<span id="cb5-9"></span>
<span id="cb5-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bind_rows</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">eval</span>(reg),</span>
<span id="cb5-11">               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">eval</span>(trimmed_ols),</span>
<span id="cb5-12">               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">eval</span>(log_reg, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type.predict =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"response"</span>),</span>
<span id="cb5-13">               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">eval</span>(prob_reg, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type.predict =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"response"</span>),</span>
<span id="cb5-14">               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">eval</span>(cauch_reg, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type.predict =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"response"</span>)</span>
<span id="cb5-15">               )) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">model =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OLS"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"trimmed OLS"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"logit"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"probit"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cauchit"</span>), </span>
<span id="cb5-17">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(model, .metric, .estimator, .estimate) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(.metric, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(.estimate))</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in predict.lm(x, newdata = newdata, na.action = na.pass, ...):
prediction from a rank-deficient fit may be misleading

Warning in predict.lm(x, newdata = newdata, na.action = na.pass, ...):
prediction from a rank-deficient fit may be misleading</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
prediction from a rank-deficient fit may be misleading

Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
prediction from a rank-deficient fit may be misleading

Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
prediction from a rank-deficient fit may be misleading</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
   model       .metric  .estimator .estimate
   &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
 1 cauchit     accuracy binary         0.836
 2 logit       accuracy binary         0.827
 3 probit      accuracy binary         0.826
 4 OLS         accuracy binary         0.825
 5 trimmed OLS accuracy binary         0.823
 6 cauchit     kap      binary         0.644
 7 logit       kap      binary         0.630
 8 probit      kap      binary         0.628
 9 OLS         kap      binary         0.625
10 trimmed OLS kap      binary         0.623</code></pre>
</div>
</div>
<p>Looks like the cauchit model has the highest accuracy, and OLS isn’t too far behind the logit. But why does the cauchit link function perform better?</p>
<blockquote class="blockquote">
<p>The “cauchit” model is attractive when observed responses exhibit a few surprising values, observations for which the linear predictor is large in absolute value indicating that the outcome is almost certain, and yet the linear predictor is wrong. (http://www.econ.uiuc.edu/~roger/research/links/links.pdf)</p>
</blockquote>
<p>I’m having trouble braining this paragraph, but it sounds like the cauchit is robust to large values of the predictors. Is this the case? For simplicity I check the fitted values from the linear model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb9-2">reg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb9-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">augment</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb9-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> .fitted)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.philipscurve.com/post/2019-07-14-link-functions-matter_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Seems to be a few extreme cases, but not too harsh.</p>



 ]]></description>
  <guid>https://www.philipscurve.com/post/2019-07-14-link-functions-matter.html</guid>
  <pubDate>Sun, 14 Jul 2019 00:00:00 GMT</pubDate>
  <media:content url="https://www.philipscurve.com/img/384608250_535b9a6840_z.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Reflections on the tidyverse</title>
  <dc:creator>Philip Khor</dc:creator>
  <link>https://www.philipscurve.com/post/reflections-on-the-tidyverse/</link>
  <description><![CDATA[ 





<p>At my previous gig as a junior data scientist trainer, my team was given some time to revamp our base R-based syllabus to be more tidy-friendly while retaining significant base-R content.</p>
<p>This article is not written as an introduction to the tidyverse. It assumes you already work with the tidyverse, and is really just me jotting down my notes from the revamp exercise.</p>
<section id="the-tidyverse-is-opinionated" class="level2">
<h2 class="anchored" data-anchor-id="the-tidyverse-is-opinionated">The tidyverse is opinionated</h2>
<p>There’s decisions made for your own good, and that’s bound to split people. For example, you <a href="https://stackoverflow.com/questions/3099219/ggplot-with-2-y-axes-on-each-side-and-different-scales">can’t make dual y-axis charts in <code>ggplot2</code></a>. And that’s probably for the best (imo).</p>
</section>
<section id="the-tidyverse-is-designed-to-be-readable" class="level2">
<h2 class="anchored" data-anchor-id="the-tidyverse-is-designed-to-be-readable">The tidyverse is designed to be readable</h2>
<p>After skimming over base data structures, I start out my <code>dplyr</code> classes not showing users anything but a code chunk something like this</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">mtcars <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames_to_columns</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(cyl, mpg) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(cyl <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-5">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(mpg) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">litres_per_100km =</span> mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.72</span>)</span></code></pre></div>
<p>and asking students to guess what the code is doing. While I tested this on only two groups of students, generally this example made sense, and is a great motivation to use the tidyverse.</p>
<p>For me, starting out with skimming over base basics is probably the ideal approach. At the least, cover basic atomic vectors and lists. It’d be difficult to show how to use functions operating on vectors in <code>mutate()</code> (and maybe the <code>.data</code> pronoun) with limited experience in base otherwise.</p>
<p>As we designed the course, we discovered that <code>dplyr</code> had convenient database backends that connect to SQL and Spark, and this was an added motivation for learning <code>dplyr</code> syntax well.</p>
</section>
<section id="the-tidyverse-is-designed-to-be-safe" class="level2">
<h2 class="anchored" data-anchor-id="the-tidyverse-is-designed-to-be-safe">The tidyverse is designed to be safe</h2>
<p>I take safety in the tidyverse to mean anticipate user mistakes and to guard against these mistakes. I think they call it ‘defensive programming’? However I concede most of the progress in safety is with <code>purrr</code> and less so in <code>dplyr</code> (my impression).</p>
<ol type="1">
<li><p><strong>No side-effects</strong> A key principle in the design of <code>dplyr</code> functions is that the function should not affect the original data frame. We designed our material in Jupyter Notebooks, where <a href="https://yihui.name/en/2018/09/notebook-war/#1-hidden-state-and-out-of-order-execution">out-of-order execution</a> was an issue. In the context of material designed in Jupyter Notebooks, a no-side-effects workflow is advantageous, since if you run cells out of order, you could potentially get different results. This is less of a problem in R Markdown because the user is encouraged to knit the document. pandas seems to be headed in a similar direction, deprecating the <code>inplace = True</code> argument altogether and encouraging the use of method chaining.</p></li>
<li><p><strong>safer functions</strong>: The tidyverse includes type-safe versions of base functions such as <code>if_else()</code>vs.&nbsp;<code>ifelse()</code> and especially type-safe functional programming (<code>purrr::map()</code> functions vs.&nbsp;<code>sapply()</code> with its set of simplification rules).</p></li>
</ol>
</section>
<section id="pipes-are-good-but-to-teach" class="level2">
<h2 class="anchored" data-anchor-id="pipes-are-good-but-to-teach">Pipes are good, but to teach?</h2>
<p>R <code>magrittr</code> pipes were inspired by UNIX pipes. While I’m not familiar with using them, they’ve been around for a while.</p>
<p>Pipes, combined with <code>dplyr</code> verbs, provide a SQL-like logic to your code. In R for Data Science, the authors compare</p>
<p><code>x(y(z(a)))</code></p>
<p><code>a %&gt;% z() %&gt;% y() %&gt;% x()</code></p>
<p>where the first example is less human-readable, since it doesn’t follow the sequence of operations performed.</p>
<p>Pandas <a href="https://tomaugspurger.github.io/method-chaining">method chaining</a> uses a similar workflow. I’m so used to using <code>dplyr</code> now, the first thing I look up before doing a data analysis project on tabular data in Python is the corresponding methods in <code>pandas</code> for the <code>dplyr</code> verbs. While I’m less familiar with the pandas methods, using them in conjunction with method chaining make for much more readable code, and using them is a priority for me if I’m doing extensive analysis in pandas.</p>
<p>I’m not sure if pipes are easy to teach for most audiences given my limited experience, but they are critical to teaching in the tidyverse imo. It’s worked for me so far, but students often forget about the first argument.</p>
</section>
<section id="consistent-design" class="level2">
<h2 class="anchored" data-anchor-id="consistent-design">Consistent design</h2>
<p>tidyverse functions have generally consistent design. For learners, this generally means learning a few functions allows you to reuse that knowledge with other functions with relative ease. tidyverse functions and packages offer consistent arguments across functions and packages, e.g.&nbsp;<code>readr</code>, <code>readxl</code>.</p>
<p>The biggest common denominator across the tidyverse is the data-first paradigm. An example how this helps is how it may be easier to teach functional programming in <code>purrr</code> compared to base R, since the multivariate versions of the <code>apply</code> functions contain the data within the ellipsis argument, which is the <em>last</em> argument, versus with <code>lapply()</code>/<code>sapply()</code> where the data is the <em>first</em> argument.</p>
<p>The <code>tidyverse</code> is designed as a grammar, or perhaps a way to speak about the operations you’re running. <code>dplyr</code> is the tidyverse’s grammar for manipulating tabular data encapsulated in 6 verbs and their variants, whereas <code>ggplot2</code> is the tidyverse’s grammar for constructing charts.</p>
<p>Within the tidyverse grammar, every function is a verb. I particularly like the classification of the join verbs as mutating and filtering joins. It’s a useful heuristic for me to decide which join to use.</p>
</section>
<section id="small-core-function-set-relative-to-pandas" class="level2">
<h2 class="anchored" data-anchor-id="small-core-function-set-relative-to-pandas">Small core function set (relative to pandas?)</h2>
<p>A common way to teach <code>dplyr</code>, as I found in many tutorials, is to help students master the 6 core <code>dplyr</code> functions <strong>first</strong>. I emphasise while teaching that functions such as <code>rename()</code> are shortcuts for these 6 functions, and there are always workarounds to do what you need even if you can’t find/don’t remember the shortcuts. It takes pressure off the student to ‘remember <code>everything()</code>’.</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">mtcars <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-2">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">miles_per_gallon =</span> mpg)</span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># is equivalent to</span></span>
<span id="cb2-5">mtcars <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">miles_per_gallon =</span> mpg, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">everything</span>())</span>
<span id="cb2-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># provided you don't care about the ordering of the columns</span></span></code></pre></div>
</section>
<section id="tibbles-are-simpler" class="level2">
<h2 class="anchored" data-anchor-id="tibbles-are-simpler">Tibbles are <em>simpler</em></h2>
<p>There are only two differences between the base data frame and the tibble: (1) a different print method that considers console size and (2) not allowing rownames. (If you go by R4DS, tibbles are more restrictive and complain more) If anything students don’t need to learn about row names, because frankly they don’t need them. (Wrangling MultiIndex is something I certainly don’t miss from pandas … )</p>
<p>The requirement for <strong>tidy data</strong> is shared between <code>ggplot2</code> and <code>seaborn</code>. Tidy data seems to get less emphasis in the Python ecosystem (this <a href="https://tomaugspurger.github.io/modern-5-tidy">pandas course</a> seems to be an excellent exception), and students didn’t have a good mental model for thinking about how to prepare their data before plotting or modelling.</p>
</section>
<section id="base-r-pains" class="level2">
<h2 class="anchored" data-anchor-id="base-r-pains">Base R pains</h2>
<p>Still having not worked much with R, I didn’t get the pains with base until after reading a few chapters in R for Data Science. <code>is.vector()</code> for example returns <code>TRUE</code> for a list, because a list is just a recursive vector. This is annoying if you wanted to simplify the teaching of atomic vectors as <em>vectors</em> and the students try running <code>is.vector()</code> …</p>
<p><code>stringsAsFactors = TRUE</code> in <code>read.csv</code> is a less-than-ideal default for data analysis. The argument defines the order of the factor levels before the user manipulates them, and the user is unaware of the order of the factor levels. If the user isn’t aware of the default, data analysis can be a bit of a pain. (Although I concede that <code>read_csv()</code> has failed me on one occasions. However, I never understood reprex well enough to file a good bug when it happened. )</p>
<p>We’ve been bitten by the ellipsis (<code>...</code>) argument in functions such as <code>mean()</code>. Because of the ellipsis argument, the following lines of code run without error:</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># rm.na is not a valid named argument, but no error is returned</span></span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rm.na =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># returns 1</span></span>
<span id="cb3-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
</section>
<section id="emphasis-on-code-style-from-the-outset" class="level2">
<h2 class="anchored" data-anchor-id="emphasis-on-code-style-from-the-outset">Emphasis on code style from the outset</h2>
<p>The tidyverse emphasises using a consistent casing for objects. Snake case is preferred across all objects. <code>janitor::clean_names()</code> is a great way to enforce this, to coerce all column names to snakecase. It’s easy to promote the perks of consistent code style to students given good examples and opinionated design in the tidyverse. Having to use backticks as escape characters otherwise is a good motivation for using <code>janitor::clean_names()</code>.</p>
<p>One thing I like about teaching <code>dplyr</code> functions is that they implicitly discourage integer indexing in favour of making filtering/selecting decisions explicit, although it is still possible, for instance,</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb4-2">df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)</span></code></pre></div>
<p>One could argue indexing is still required for data partitions for predictive modelling, but I’d argue <code>rsample</code> circumvents that</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(rsample)</span>
<span id="cb5-2">df_split <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">initial_split</span>(df)</span>
<span id="cb5-3">df_train <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">training</span>(df_split)</span>
<span id="cb5-4">df_test <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">testing</span>(df_split)</span></code></pre></div>
<p>Of course, there’s always <code>dplyr::sample_n()</code> and <code>dplyr::sample_frac()</code>, which can be used in conjunction with a filtering join:</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample_frac</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> df_train</span>
<span id="cb6-2">df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anti_join</span>(df_train) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> df_test</span></code></pre></div>
</section>
<section id="debugging" class="level2">
<h2 class="anchored" data-anchor-id="debugging">Debugging</h2>
<p>It is very true that debugging in a long series of pipes can be a pain, and I think <code>dplyr</code> should provide more messages. Stata has <a href="https://twitter.com/AnnaMBokun/status/1146289574999678977">useful reports</a> on operations that <code>dplyr</code> can benefit from implementing, and independent efforts such as <a href="https://github.com/elbersb/tidylog">tidylog</a> help report the outcomes of data wrangling.</p>
</section>
<section id="conclusions" class="level2">
<h2 class="anchored" data-anchor-id="conclusions">Conclusions</h2>
<p>There are parts I still find awkward to teach in the tidyverse.</p>
<ul>
<li>Like how to explain how symbols work when used in <code>dplyr</code> functions. Teaching it as ‘exposes the vectors within a data frame within an environment’ just doesn’t seem very beginner-friendly, and I need to find a simpler way.<br>
</li>
<li>The multitude of packages to teach to accomplish different tasks gets annoying at times (I wish I could start off with <code>here()</code> as soon as we talk about importing data without confusing students with an additional import!).</li>
<li>I wish <code>dplyr</code> returns a warning when removing rownames because users aren’t aware that the rownames are being dropped (but the only use case here is <code>mtcars</code>, really …).</li>
<li>I still get <code>top_n()</code> wrong. All the time.</li>
<li>And don’t even get me started with tidyeval …</li>
</ul>
<p>My teaching philosophy is to teach people to work with data efficiently with good data analysis workflows, not to become package authors (although that’d be nice!). I find that <code>dplyr</code> helps me think about my analysis faster. I don’t deal with datasets so big that I really care how long my code takes to run, so long as I do it right. But my teaching days are over … for now.</p>


</section>

 ]]></description>
  <category>R</category>
  <category>tidyverse</category>
  <guid>https://www.philipscurve.com/post/reflections-on-the-tidyverse/</guid>
  <pubDate>Sun, 07 Jul 2019 00:00:00 GMT</pubDate>
  <media:content url="https://www.philipscurve.com/post/reflections-on-the-tidyverse/featured.png" medium="image" type="image/png" height="166" width="144"/>
</item>
</channel>
</rss>
